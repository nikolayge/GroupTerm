* >Natural Source Header 000000
* :Mode S
* :CP
* <Natural Source Header
/** New Subprogram ORDSRV.
/**
/** :author nguentchev
DEFINE DATA
PARAMETER
1 FUNCTION-NAME       (A) Dynamic        /* In
1 INPUT-DATA          (A) Dynamic        /* In
1 RESPONSE-DATA       (A) Dynamic        /* Out
LOCAL
1 #Unsupported        (A2) CONST <'-1'>
1 #Timeout            (A2) CONST <'-2'>
1 #Natural-error      (A2) CONST <'-3'>
1 #MESSAGE-LOG        (I4) CONST <2>
1 #ERROR-LOG          (I4) CONST <3>
1 #REQUEST-LOG        (I4) CONST <4>
1 #UPDATE-LOG         (I4) CONST <5>

1 #CREATE-ORDER   (A24) CONST <'CreateOrder'>

1 #MESSAGE            (A) DYNAMIC
1 #MESSAGE-ID         (A) DYNAMIC
1 #ERROR-CODE         (I4)
END-DEFINE
/* 
ON ERROR
  IF *ERROR-NR = 3009
    RESPONSE-DATA := #Timeout
  ELSE
    RESET #ERROR-CODE #MESSAGE
    CALLNAT 'CRMLOGA' 
      #ERROR-CODE
      #MESSAGE
      #ERROR-LOG 
      #MESSAGE-ID
    RESPONSE-DATA := #Natural-error
    BACKOUT TRANSACTION
  END-IF
  ESCAPE ROUTINE
END-ERROR

#MESSAGE := INPUT-DATA
#MESSAGE-ID := 'UNIX'
CALLNAT 'CRMLOGA' 
  #ERROR-CODE
  #MESSAGE
  #REQUEST-LOG 
  #MESSAGE-ID

DECIDE ON FIRST VALUE OF FUNCTION-NAME
  VALUE #CREATE-ORDER
    CALLNAT 'ORDNCRTE'
      INPUT-DATA
      RESPONSE-DATA
  NONE VALUE
    RESPONSE-DATA := #Unsupported
END-DECIDE
END
