* >Natural Source Header 000000
* :Mode S
* :CP ISO_8859-1:1987
* :LineIncrement 10
* <Natural Source Header
*
DEFINE DATA
LOCAL USING SVCA0003
LOCAL
1 #ID-NUMBER    (N6)
1 WORK-AMT      (N7.2)
1 #AMT-DUE      (N7.2)
1 #MSG          (A) DYNAMIC
END-DEFINE
*
INPUT ///
  / 'Member ID...' #ID-NUMBER
  / 'Funds.......' WORK-AMT
*
IF #ID-NUMBER > 0
  PARM-SVC.SVC-PLAN      := 'PSM'
  PARM-SVC.SVC-MEMBER-ID := #ID-NUMBER
  SVC-PAY-AMOUNT   := WORK-AMT
  PARM-SVC.ACTION  := 'ONEMONTH'
  PARM-SVC.TRANSACTION-TIMN := *TIMN
  PARM-SVC.TRANSACTION-DATN := *DATN
  CALLNAT 'SVCN0003' PARM-SVC #MSG
  IF #MSG = ' '
    ADD PARM-SVC.SVC-MONTHLY-RATE TO #AMT-DUE
    SUBTRACT PARM-SVC.SVC-MONTHLY-RATE FROM WORK-AMT
    END TRANSACTION
  END-IF
  PRINT PARM-SVC
    / 'Member ID...' #ID-NUMBER
    / 'Funds.......' WORK-AMT
    / 'Dues........' #AMT-DUE
END-IF
*
END
