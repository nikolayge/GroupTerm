* >Natural Source Header 000000
* :Mode S
* :CP ISO_8859-1:1987
* :LineIncrement 5
* <Natural Source Header
* PROGRAM-ID: G4103PMS   ** AFSC STATS & INVOICE
* <<<<< when the afsc rates are changed also change GOPTOSXX <<<<<<
*******************************************
*                       MODIFICATION LOG
* USER DATE     TAG  REASON
* DRW  06132005 DW1  Add 7/1/2005 rates
* DRW  03032006 DW2  Add 7/1/2006 rates
* DRW  10182006 DW3  Add Subtotals for lifetime & Spc Contracts clients
* DRW  11292006 DW4  Add 7/1/2007 rates
* DRW  11262006 DW5  Add 7/1/2008 rates
* DRW 03/30/2009 DW6 Add 7/1/2009 rates (Also chg C2H30PVW)
* DRW 10/23/2009 DW7 AFFL UNification
* RSE 06/28/2010 RE1 Change 'AFSC' to 'AFA'; change screen G4144MMS (AFSC MTD Statistics)
* PAM 07/27/2010 PM8 Changes for AAFMAA Financial and re-grandfathered status
* vxt 01/11/2011 Vt1 Add rates.
* NGG    03/02/2012  NG1     Premier service changes                   *
* VXT 08/23/2012 vt2 Replaced PAM with VXT
* VXT 01/21/2012 vt3 Add rates.
* vxt 01/22/2014 vt4 add rates /ticket 2520/
* vxt 01/14/2015 vt5 Add rates  /Ticket 1691- reopened for new year 2015 /
* vxt 12/23/2016 vt6 Add the new rates for 2017
* vxt 12/28/2017 vt7 /Ticket 6975/ New rates for 2018
******************************************
*
* MODIFICATIONS:
*
DEFINE DATA
GLOBAL USING BCOMMGXX WITH MASTER-BLOCK
LOCAL USING GONERLXX        /* WORK FIELDS FOR 'GONERCXX'
LOCAL
*
1 #GF-MON-RATE     (N1.2) INIT <2.55> /* these 1st 6 rates will be
1 #PL-MON-RATE     (N1.2) INIT <2.00> /* overridden based on curr date
1 #GF-WID-MON-RATE (N1.2) INIT <1.14>
1 #IO-WID-MON-RATE (N1.2) INIT <0.10>
1 #GW-DEATH-RATE   (N3.2) INIT <642.00>  /* death with widow
1 #GN-DEATH-RATE   (N3.2) INIT <255.30>  /* death w/o widow
* below went into effect 7/1/2000
1 #GF-MON-RATE-00     (N1.2) INIT <2.55>
1 #PL-MON-RATE-00     (N1.2) INIT <2.00>
1 #GF-WID-MON-RATE-00 (N1.2) INIT <1.14>
1 #IO-WID-MON-RATE-00 (N1.2) INIT <0.10>
1 #GW-DEATH-RATE-00   (N3.2) INIT <642.00>  /* death with widow
1 #GN-DEATH-RATE-00   (N3.2) INIT <255.30>  /* death w/o widow
* below went into effect 7/1/2001
1 #GF-MON-RATE-01     (N1.2) INIT <2.64>
1 #PL-MON-RATE-01     (N1.2) INIT <2.00>
1 #GF-WID-MON-RATE-01 (N1.2) INIT <1.18>
1 #IO-WID-MON-RATE-01 (N1.2) INIT <0.10>
1 #GW-DEATH-RATE-01   (N3.2) INIT <664.47>  /* death with widow
1 #GN-DEATH-RATE-01   (N3.2) INIT <264.24>  /* death w/o widow
* below went into effect 7/1/2002
1 #GF-MON-RATE-02     (N1.2) INIT <2.71>
1 #GF-MON-RATE-02-B   (N1.2) INIT <2.70> /*WENT INTO EFFECT 10/2002
1 #PL-MON-RATE-02     (N1.2) INIT <2.00>
1 #GF-WID-MON-RATE-02 (N1.2) INIT <1.21>
1 #IO-WID-MON-RATE-02 (N1.2) INIT <0.10>
1 #GW-DEATH-RATE-02   (N3.2) INIT <681.75>  /* death with wido
1 #GN-DEATH-RATE-02   (N3.2) INIT <271.11>  /* death w/o widow
* below went into effect 7/1/2003
1 #GF-MON-RATE-03     (N1.2) INIT <2.74>
1 #PL-MON-RATE-03     (N1.2) INIT <2.00>
1 #GF-WID-MON-RATE-03 (N1.2) INIT <1.23>
1 #IO-WID-MON-RATE-03 (N1.2) INIT <0.10>
1 #GW-DEATH-RATE-03   (N3.2) INIT <691.29>  /* death with wido
1 #GN-DEATH-RATE-03   (N3.2) INIT <274.91>  /* death w/o widow
* below went into effect 7/1/2004 - entered 2/26/2004
1 #GF-MON-RATE-04     (N1.2) INIT <2.80>
1 #PL-MON-RATE-04     (N1.2) INIT <2.00>
1 #GF-WID-MON-RATE-04 (N1.2) INIT <1.26>
1 #IO-WID-MON-RATE-04 (N1.2) INIT <0.10>
1 #GW-DEATH-RATE-04   (N3.2) INIT <705.81>  /* death with wido
1 #GN-DEATH-RATE-04   (N3.2) INIT <280.68>  /* death w/o widow
* below went into effect 7/1/2005 - entered 6/13/2005    /* DW1
1 #GF-MON-RATE-05     (N1.2) INIT <2.88>
1 #PL-MON-RATE-05     (N1.2) INIT <2.00>
1 #GF-WID-MON-RATE-05 (N1.2) INIT <1.29>
1 #IO-WID-MON-RATE-05 (N1.2) INIT <0.10>
1 #GW-DEATH-RATE-05   (N3.2) INIT <724.87>  /* death with wido
1 #GN-DEATH-RATE-05   (N3.2) INIT <288.26>  /* death w/o widow
* below went into effect 7/1/2006 - entered 3/03/2006    /* DW2
1 #GF-MON-RATE-06     (N1.2) INIT <3.00>
1 #PL-MON-RATE-06     (N1.2) INIT <2.00>
1 #GF-WID-MON-RATE-06 (N1.2) INIT <1.34>
1 #IO-WID-MON-RATE-06 (N1.2) INIT <0.10>
1 #GW-DEATH-RATE-06   (N3.2) INIT <754.59>  /* death with wido
1 #GN-DEATH-RATE-06   (N3.2) INIT <300.08>  /* death w/o widow /* DW2
* below went into effect 7/1/2007 - entered 11/25/2006   /* DW4
1 #GF-MON-RATE-07     (N1.2) INIT <3.10>
1 #PL-MON-RATE-07     (N1.2) INIT <2.00>
1 #GF-WID-MON-RATE-07 (N1.2) INIT <1.38>
1 #IO-WID-MON-RATE-07 (N1.2) INIT <0.10>
1 #GW-DEATH-RATE-07   (N3.2) INIT <779.49>  /* death with wido
1 #GN-DEATH-RATE-07   (N3.2) INIT <309.98>  /* death w/o widow /* DW4
* below went into effect 7/1/2008 - entered 11/26/2007   /* DW5
1 #GF-MON-RATE-08     (N1.2) INIT <3.17>
1 #PL-MON-RATE-08     (N1.2) INIT <2.00>
1 #GF-WID-MON-RATE-08 (N1.2) INIT <1.41>
1 #IO-WID-MON-RATE-08 (N1.2) INIT <0.10>
1 #GW-DEATH-RATE-08   (N3.2) INIT <797.42>  /* death with wido
1 #GN-DEATH-RATE-08   (N3.2) INIT <317.11>  /* death w/o widow /* DW5
*
* BELOW WENT INTO EFFECT 7/1/2009 - ENTERED 03/27/2009   /* DW6
1 #GF-MON-RATE-09     (N1.2) INIT <3.35>
1 #PL-MON-RATE-09     (N1.2) INIT <2.00>
1 #GF-WID-MON-RATE-09 (N1.2) INIT <1.49>
1 #IO-WID-MON-RATE-09 (N1.2) INIT <0.11>
1 #GW-DEATH-RATE-09   (N3.2) INIT <843.67>  /* DEATH WITH WIDO
1 #GN-DEATH-RATE-09   (N3.2) INIT <335.50>  /* DEATH W/O WIDOW /* DW6
*
* BELOW WENT INTO EFFECT 1/1/2012 - ENTERED 01/30/2012                /* vt1 \/
1 #GF-MON-RATE-10     (N1.2) INIT <3.47>
1 #PL-MON-RATE-10     (N1.2) INIT <2.00>
1 #GF-WID-MON-RATE-10 (N1.2) INIT <1.54>
1 #IO-WID-MON-RATE-10 (N1.2) INIT <0.11>
1 #GW-DEATH-RATE-10   (N3.2) INIT <874.04>  /* DEATH WITH WIDO
1 #GN-DEATH-RATE-10   (N3.2) INIT <347.58>  /* DEATH W/O WIDOW        /* vt1 /\
*
* BELOW WENT INTO EFFECT 1/1/2013 - ENTERED 01/30/2013                /* vt3 \/
1 #GF-MON-RATE-11     (N1.2) INIT <3.53>
1 #PL-MON-RATE-11    (N1.2) INIT <2.00>
1 #GF-WID-MON-RATE-11 (N1.2) INIT <1.57>
1 #IO-WID-MON-RATE-11 (N1.2) INIT <0.11>
1 #GW-DEATH-RATE-11   (N3.2) INIT <888.90>  /* DEATH WITH WIDO
1 #GN-DEATH-RATE-11  (N3.2) INIT <353.49>  /* DEATH W/O WIDOW        /* vt3 /\
*
*  BELOW WENT INTO EFFECT 1/1/2014 - ENTERED 01/30/2014                /* vt4 \/
1 #GF-MON-RATE-12     (N1.2) INIT <3.58>
1 #PL-MON-RATE-12    (N1.2) INIT <2.00>
1 #GF-WID-MON-RATE-12 (N1.2) INIT <1.59>
1 #IO-WID-MON-RATE-12 (N1.2) INIT <0.12>
1 #GW-DEATH-RATE-12   (N3.2) INIT <902.23>  /* DEATH WITH WIDO
1 #GN-DEATH-RATE-12  (N3.2) INIT <358.79>  /* DEATH W/O WIDOW        /* vt4 /\
*
*  BELOW WENT INTO EFFECT 1/1/2014 - ENTERED 01/30/2014                /* vt5 \/
1 #GF-MON-RATE-13     (N1.2)  INIT <3.64>
1 #PL-MON-RATE-13     (N1.2)  INIT <2.00>
1 #GF-WID-MON-RATE-13 (N1.2)  INIT <1.61>
1 #IO-WID-MON-RATE-13 (N1.2)  INIT <0.12>
1 #GW-DEATH-RATE-13   (N3.2)  INIT <917.57>  /* DEATH WITH WIDO
1 #GN-DEATH-RATE-13   (N3.2)  INIT <364.89>  /* DEATH W/O WIDOW        /* vt5/\
*
*  BELOW WENT INTO EFFECT 1/1/2017 - ENTERED 01/01/2017                /* vt6 \/
1 #GF-MON-RATE-14     (N1.2)  INIT <3.66>
1 #PL-MON-RATE-14     (N1.2)  INIT <2.00>
1 #GF-WID-MON-RATE-14 (N1.2)  INIT <1.63>
1 #IO-WID-MON-RATE-14 (N1.2)  INIT <0.14>
1 #GW-DEATH-RATE-14   (N3.2)  INIT <920.32>  /* DEATH WITH WIDO
1 #GN-DEATH-RATE-14   (N3.2)  INIT <366.00>  /* DEATH W/O WIDOW        /* vt6 /\
*
*  BELOW WENT INTO EFFECT 1/1/2018 - ENTERED 01/01/2018                /* vt7 \/
1 #GF-MON-RATE-15     (N1.2)  INIT <3.74>
1 #PL-MON-RATE-15     (N1.2)  INIT <2.00>
1 #GF-WID-MON-RATE-15 (N1.2)  INIT <1.67>
1 #IO-WID-MON-RATE-15 (N1.2)  INIT <0.15>
1 #GW-DEATH-RATE-15   (N3.2)  INIT <940.00>  /* DEATH WITH WIDO
1 #GN-DEATH-RATE-15   (N3.2)  INIT <374.00>  /* DEATH W/O WIDOW        /* vt7 /\
*
1 MS-DETH-V VIEW OF A-MBRSHIP-STATS
  2 LOSS-MBRS     (1)  /* to count 1 yrs worth of deaths
*
1 #TOT-MTD-AFSC-GAINS  (P5)
1 #TOT-MTD-AFSC-LOSSES (P5)
1 #TOT-DETHS    (P7)
1 #AVG-DETHS    (P5)
1 #PROJ-GF-DETHS  (P5)
1 #PROJ-OTH-DETHS (P5)
1 #ADJ-GF-DETHS  (P5)
1 #ADJ-OTH-DETHS (P5)
1 #OTH-DEATHS-CURR (P5)
*
1 MS-V VIEW OF A-MBRSHIP-STATS
  2 MONTH-KEY
  2 MTD-AFSC-GAINS-BY-PLAN (12)
  2 MTD-AFSC-LOSSES-BY-TYPE (2)
  2 ME-AFSC-GAINS-P-L
  2 ME-AFSC-GAINS-COMBO
  2 ME-AFSC-GAINS-S-O
  2 ME-AFSC-LOSSES-P-L
  2 ME-AFSC-LOSSES-COMBO
  2 ME-AFSC-LOSSES-S-O
  2 ME-AFSC-BY-PLAN     (12)
  2 ME-AFSC-BY-SVC      (6)
  2 ME-AFSC-BY-RANK     (7)
  2 ME-AFSC-BY-AGE      (9)
  2 ME-AFSC-G-F-LOSSES-DEATH
  2 ME-AFSC-G-F-LOSSES-NON-DEATH
  2 ME-AFSC-AAFM-TOTS   (5)
  2 ME-AFSC-AAFM-DEATHS (6)
  2 ME-AFSC-AAFM-WIDS-SERVED
  2 ME-AFSC-AAFM-WIDS-NOT-SERVED
  2 ME-AFSC-WIDS-SERVED
  2 ME-AFSC-WIDS-NOT-SERVED
  2 ME-AFSC-AAFM-DOD-CURR-YR-GF
  2 ME-AFSC-AAFM-DOD-CURR-YR-PRJ-GF
  2 ME-AFSC-AAFM-WIDS-SERVED-GF
  2 ME-AFSC-AAFM-WIDS-NOT-SERVED-GF
  2 ME-AFSC-AAFM-DOD-CURR-YR-IO
  2 ME-AFSC-AAFM-DOD-CURR-YR-PRJ-IO
  2 ME-AFSC-AAFM-WIDS-SERVED-IO
  2 ME-AFSC-AAFM-WIDS-NOT-SERVED-IO
  2 ME-AFSC-WID-DETHS-UND90-GF
  2 ME-AFSC-WID-DETHS-MONS-UND90-GF
  2 ME-AFSC-WID-DETHS-OVR90-GF
  2 ME-AFSC-WID-DETHS-MONS-OVR90-GF
  2 ME-AFSC-LIFETIME-MBRS
* BELOW ADDED 5/29/2002
  2 ME-AFSC-AAFM-I-P-B4      (3)   /* de-gf/opt-out/all-else
  2 ME-AFSC-AAFM-I-P-AFT     (3)   /* ''
  2 ME-AFSC-AAFM-DEATHS-I-P  (3)   /* ''
  2 ME-AFSC-BY-STATUS        (3)   /* active/retired/all else
* BELOW ADDED 3/19/2003
  2 AER-CLIENTS
  2 NMCRS-CLIENTS
  2 AFAS-CLIENTS
  2 UWSF-CLIENTS
  2 NRS-CLIENTS
  2 MCRS-CLIENTS
* BELOW ADDED 5/20/2004
  2 CGMA-CLIENTS
  2 ME-PSM-PLANS        /* NG1
  2 ME-PSM-GAINS        /* NG1
  2 ME-PSM-LOSSES       /* NG1
  2 ME-PSM-AMOUNT       /* NG1
*
1 #TOT-SPECIAL-CLIENTS       (N6)  /* SUM OF AER,NMCRS,AFAS,CGMA
1 #LIFETIME-MBRS-NON-SPC-CLIENTS  (N6)   /* DW3
1 #AAFMAA-LST-MON-PL           (P7)
1 #AAFMAA-PL-LOSS              (P5)
1 #AFSC-LAST-MON-WIDS-SERVED-GF(P7)
1 #AFSC-LAST-MON-WIDS-SERVED-IO(P7)
1 #LAST-MON-DOD-CURR-YR-GF     (P7)
1 #LAST-MON-DOD-CURR-YR-IO     (P7)
*
1 #AFSC-BEG-MONTH      (P7)
1 #AFSC-TOT-GAINS      (P5)
1 #AFSC-TOT-LOSSES     (P5)
1 #AFSC-END-MONTH      (P7)
1 #AAFMAA-GF-BEG-MONTH (P7)
1 #AAFMAA-END-MONTH    (P7)
1 #AAFMAA-TOT-DEATHS   (P7)
1 #AAFMAA-TOT-WIDOWS   (P7)
1 #AFSC-TOT-WIDOWS     (P7)
1 #AFSC-CURR-BILLABLE-GF  (P7)
1 #AFSC-CURR-BILLABLE-IO  (P7)
1 #AFSC-NXT-MON-BILLABLE-GF  (P7)
1 #AFSC-NXT-MON-BILLABLE-IO  (P7)
*
1 #BILL-GF-MONTHLY       (N7.2)
1 #BILL-PL-MONTHLY       (N7.2)
1 #BILL-GF-WIDS-MONTHLY  (N7.2)
1 #BILL-IO-WIDS-MONTHLY  (N7.2)
1 #BILL-GF-DEATHS        (N7.2)
1 #BILL-OTH-DEATHS       (N7.2)
1 #BILL-WID-CRED-OVR90   (N7.2)
1 #BILL-WID-CRED-UND90   (N7.2)
1 #SUB-TOT-BILL          (N7.2)
1 #TOT-BILL              (N7.2)
*
1 #NXT-BILL-GF-MONTHLY       (N7.2)
1 #NXT-BILL-PL-MONTHLY       (N7.2)
1 #NXT-BILL-GF-WIDS-MONTHLY  (N7.2)
1 #NXT-BILL-IO-WIDS-MONTHLY  (N7.2)
1 #NXT-BILL-GF-DEATHS        (N7.2)
1 #NXT-BILL-OTH-DEATHS       (N7.2)
1 #NXT-SUB-TOT-BILL          (N7.2)
1 #NXT-TOT-BILL              (N7.2)
*
1 #ADJ-BILL-GF-MONTHLY       (N7.2)
1 #ADJ-BILL-PL-MONTHLY       (N7.2)
1 #ADJ-BILL-GF-WIDS-MONTHLY  (N7.2)
1 #ADJ-BILL-IO-WIDS-MONTHLY  (N7.2)
1 #ADJ-BILL-GF-DEATHS        (N7.2)
1 #ADJ-BILL-OTH-DEATHS       (N7.2)
1 #ADJ-TOT-BILL              (N7.2)
1 #ADJUSTMENT                (N7.2)
1 #FINAL-BILL                (N7.2)
*
1 #DATN-DISP   (A11)
1 #CURR-MON    (A3)
1 #CURR-YEAR   (N4)
1 #NEXT-MON    (A3)
1 #NEXT-YEAR   (N4)
1 #BEG-OF-DOD-WINDOW (A9)
1 #END-OF-DOD-WINDOW (A10)
1 #BEG-OF-DOD-WINDOW-PROJ (A9)
1 #END-OF-DOD-WINDOW-PROJ (A10)
*
1 #DOD-1-YR-AGO  (N6)
1 #DOD-CURR      (N6)
*
1 #MONTH-KEY  (N6)
1 REDEFINE #MONTH-KEY
  2 #MONTH-KEY-YYYY   (N4)
  2 #MONTH-KEY-MM     (N2)
*
1 #TEXT               (A60)
1 #I1                 (I2)
*
1 #DATN-YYYYMMDD      (N8)
1 REDEFINE #DATN-YYYYMMDD
  2 #DATN-YYYYMM       (N6)
  2 #DATN-DD           (N2)
*
1 #USED-DATE          (N6)
1 #RQST-YYYYMM        (N6)
1 #RQST-YYYYMM-LAST   (N6)
1 #RQST-YYYYMM-NEXT   (N6)
1 #RQST-YYYYMM-CURR   (N6)
*
1 #YYYYMMDD           (N8)
1 REDEFINE #YYYYMMDD
  2 #YYYYMM            (N6)
  2 REDEFINE #YYYYMM
    3 #YYYY             (N4)
    3 #MM               (N2)
  2 #DD                (N2)
1 REDEFINE #YYYYMMDD
  2 #YYYY-A    (A4)
  2 #MM-A      (A2)
  2 #DD-A      (A2)
*
1 #MONTHS (A36) INIT <'JanFebMarAprMayJunJulAugSepOctNovDec'>
1 REDEFINE #MONTHS
  2 #MON (A3/12)
*
1 #LAST-WS      (N6)
1 #WS           (N6)
1 #END-YYYYMM   (N6)
1 #6MO-BEG-GF         (N6)
1 #6MO-BEG-PL         (N6)
1 #6MO-BEG-WS         (N6)
1 #6MO-END-GF         (N6)
1 #6MO-END-PL         (N6)
1 #6MO-END-WS         (N6)
1 #6MO-MONS            (N3)
1 #6MO-PCT-GF  (N3.5)
1 #6MO-PCT-PL  (N3.5)
1 #6MO-PCT-WS  (N3.5)
*   below for each month bill
1 #6MO-NXT-GF  (N5)
1 #6MO-NXT-PL  (N5)
1 #6MO-NXT-WS  (N5)
*
1 #6MO-GF-BILL (N7.2)
1 #6MO-PL-BILL (N7.2)
1 #6MO-WS-BILL (N7.2)
1 #6MO-GW-BILL (N7.2)
1 #6MO-OT-BILL (N7.2)
1 #6MO-TOT-BILL (N7.2)
*   below for final bill summaey
1 #6MO-TOT-GF  (N6)
1 #6MO-TOT-PL  (N6)
1 #6MO-TOT-WS  (N6)
1 #6MO-TOT-GW  (N6)
1 #6MO-TOT-OT  (N6)
*
1 #6MO-GF-BILL-TOT (N7.2)
1 #6MO-PL-BILL-TOT (N7.2)
1 #6MO-WS-BILL-TOT (N7.2)
1 #6MO-GW-BILL-TOT (N7.2)
1 #6MO-OT-BILL-TOT (N7.2)
1 #6MO-TOT-BILL-TOT (N7.2)
*
1 #PSM-PLANS   (P5)   /* NG1
1 #PSM-GAINS   (P5)   /* NG1
1 #PSM-LOSSES  (P5)   /* NG1
1 #PSM-AMOUNT  (P7.2) /* NG1
*
END-DEFINE
*
INCLUDE GONERCXX
*
MOVE *DATN TO #YYYYMMDD
COMPRESS #DD-A #MON (#MM) #YYYY-A INTO #DATN-DISP
*
MOVE *DATN TO #DATN-YYYYMMDD
*
INPUT #RQST-YYYYMM   /* month requested
*
IF #RQST-YYYYMM LT 200006
  INPUT TEXT 'AFA stats start in June 2000' USING MAP 'G1000MXX'     /* RE1
  FETCH 'G1000PXX'
END-IF
*
MOVE #RQST-YYYYMM TO #RQST-YYYYMM-CURR
MOVE #RQST-YYYYMM TO #YYYYMM
SUBTRACT 1 FROM #MM
IF #MM LT 1
  ADD 12 TO #MM
  SUBTRACT 1 FROM #YYYY
END-IF
MOVE #YYYYMM TO #RQST-YYYYMM-LAST
*
MOVE #RQST-YYYYMM TO #YYYYMM
ADD 1 TO #MM
IF #MM GT 12
  SUBTRACT 12 FROM #MM
  ADD 1 TO #YYYY
END-IF
MOVE #YYYYMM TO #RQST-YYYYMM-NEXT
*
IF #CGA-SCR-SUFFIX =  '6MO'
  IF #RQST-YYYYMM LT 200105  /* project 1/2001 thru 6/2001
    MOVE 200012 TO #RQST-YYYYMM
  ELSE
    IF #RQST-YYYYMM LT 200111  /* project 7/2001 thru 12/2001
      MOVE 200106 TO #RQST-YYYYMM
    END-IF
  END-IF
END-IF
*
IF #RQST-YYYYMM = #YYYYMM   /* requested curr month
  MOVE #RQST-YYYYMM TO #MONTH-KEY
  FIND MS-V WITH MONTH-KEY = #MONTH-KEY  /* read current rec
    IF ME-AFSC-AAFM-TOTS (1) = 0 /* GF COUNT (TO SEE IF EMPTY REC)
      MOVE 'Curr Month not counted yet' TO #TEXT
      MOVE #RQST-YYYYMM TO #YYYYMM
      SUBTRACT 1 FROM #MM
*
      IF #MM LT 1
        ADD 12 TO #MM
        SUBTRACT 1 FROM #YYYY
      END-IF
      MOVE #YYYYMM TO #RQST-YYYYMM
    ELSE
      MOVE 'This is a partial months count' TO #TEXT
    END-IF
  END-FIND
END-IF
*
* * * * * calc avg death during last year for curr bill
*
MOVE #RQST-YYYYMM TO #YYYYMM
*
ADD 1 TO #MM
IF #MM GT 12
  SUBTRACT 12 FROM #MM
  ADD 1 TO #YYYY
END-IF
*
SUBTRACT 1 FROM #YYYY
*   IF RQST DATE IS 12/2000 BELOW WILL READ 2000/01 THRU 2000/12
FOR #I1 1 TO 12
  FIND MS-DETH-V WITH MONTH-KEY = #YYYYMM
    ADD LOSS-MBRS (1) TO #TOT-DETHS
*    IF #CGA-CLERK = 'PAM'
*     WRITE #YYYYMM LOSS-MBRS (1) #TOT-DETHS
*    END-IF
  END-FIND
*
  ADD 1 TO #MM
  IF #MM GT 12
    SUBTRACT 12 FROM #MM
    ADD 1 TO #YYYY
  END-IF
END-FOR
*
COMPUTE ROUNDED #AVG-DETHS = #TOT-DETHS / 12
* IF #CGA-CLERK = 'PAM'
*   WRITE '2000/1 THRU 200012' #AVG-DETHS #TOT-DETHS
* END-IF
* if % below is chged prior months must stay what it was
*
IF #YYYYMM > 200412
  COMPUTE ROUNDED #PROJ-GF-DETHS = #AVG-DETHS * .70 /* CHG FROM .75 KRM
ELSE
  COMPUTE ROUNDED #PROJ-GF-DETHS = #AVG-DETHS * .75
END-IF
COMPUTE #PROJ-OTH-DETHS = #AVG-DETHS - #PROJ-GF-DETHS
*
* * * * * calc avg death during last year for proj bill adjustments
*
RESET #TOT-DETHS
MOVE #RQST-YYYYMM TO #YYYYMM
SUBTRACT 1 FROM #YYYY
*   IF RQST DATE IS 12/2000 BELOW WILL READ 1999/12 THRU 2000/11
FOR #I1 1 TO 12
  FIND MS-DETH-V WITH MONTH-KEY = #YYYYMM
    ADD LOSS-MBRS (1) TO #TOT-DETHS
*   IF #CGA-CLERK = 'PAM'
*     WRITE #YYYYMM LOSS-MBRS (1) #TOT-DETHS
*   END-IF
  END-FIND
*
  ADD 1 TO #MM
  IF #MM GT 12
    SUBTRACT 12 FROM #MM
    ADD 1 TO #YYYY
  END-IF
END-FOR
*
COMPUTE ROUNDED #AVG-DETHS = #TOT-DETHS / 12
*  IF #CGA-CLERK = 'PAM'
*    WRITE '1999/12 THRU 200011' #AVG-DETHS #TOT-DETHS
*  END-IF
* if % below is chged prior months must stay what it was
IF #YYYYMM > 200412
  COMPUTE ROUNDED #ADJ-GF-DETHS = #AVG-DETHS * .70 /* CHG FROM .75 KRM
ELSE
  COMPUTE ROUNDED #ADJ-GF-DETHS = #AVG-DETHS * .75
END-IF
COMPUTE #ADJ-OTH-DETHS = #AVG-DETHS - #ADJ-GF-DETHS
*
MOVE '*' TO #CGA-SCR-COMMAND
PERFORM PROJ-6-MONS
*
IF #CGA-SCR-COMMAND NE '*'
  FETCH 'G1000PXX'
END-IF
*
* * * * * * * * setup Screen display dates
MOVE #RQST-YYYYMM TO #YYYYMM
MOVE #MON (#MM) TO #CURR-MON
MOVE #YYYY      TO #CURR-YEAR
*
ADD 1 TO #MM
IF #MM GT 12
  SUBTRACT 12 FROM #MM
  ADD 1 TO #YYYY
END-IF
MOVE #MON (#MM) TO #NEXT-MON
MOVE #YYYY      TO #NEXT-YEAR
*
*  CALC beginning of DOD window
MOVE #RQST-YYYYMM TO #YYYYMM
SUBTRACT 12 FROM #MM
IF #MM LT 1
  ADD 12 TO #MM
  SUBTRACT 1 FROM #YYYY
END-IF
*
IF #YYYYMM LT 200007
  MOVE 200007 TO #YYYYMM
END-IF
MOVE 01 TO #DD
COMPRESS #MM '1' #YYYY INTO #BEG-OF-DOD-WINDOW WITH '/'
*
*  CALC beginning of DOD window for projection
MOVE #RQST-YYYYMM TO #YYYYMM
SUBTRACT 11 FROM #MM
IF #MM LT 1
  ADD 12 TO #MM
  SUBTRACT 1 FROM #YYYY
END-IF
*
IF #YYYYMM LT 200007
  MOVE 200007 TO #YYYYMM
END-IF
MOVE 01 TO #DD
COMPRESS #MM '1' #YYYY INTO #BEG-OF-DOD-WINDOW-PROJ WITH '/'
*
*  CALC end of DOD window
MOVE #RQST-YYYYMM TO #YYYYMM
SUBTRACT 1 FROM #MM
IF #MM LT 1
  ADD 12 TO #MM
  SUBTRACT 1 FROM #YYYY
END-IF
*
IF #MM = 02
  MOVE 28 TO #DD
ELSE
  IF #MM = 4 OR = 6 OR = 9 OR = 11
    MOVE 30 TO #DD
  ELSE
    MOVE 31 TO #DD
  END-IF
END-IF
*
IF #YYYYMM LT 200007
  MOVE 20000701 TO #YYYYMMDD
END-IF
COMPRESS #MM #DD #YYYY INTO #END-OF-DOD-WINDOW WITH '/'
*
*  CALC end of DOD window for projection
MOVE #RQST-YYYYMM TO #YYYYMM
*
IF #MM = 02
  MOVE 28 TO #DD
ELSE
  IF #MM = 4 OR = 6 OR = 9 OR = 11
    MOVE 30 TO #DD
  ELSE
    MOVE 31 TO #DD
  END-IF
END-IF
*
IF #YYYYMM LT 200007
  MOVE 20000701 TO #YYYYMMDD
END-IF
COMPRESS #MM #DD #YYYY INTO #END-OF-DOD-WINDOW-PROJ WITH '/'
*
*   get LAST month record
MOVE #RQST-YYYYMM TO #MONTH-KEY
SUBTRACT 1 FROM #MONTH-KEY-MM
IF #MONTH-KEY-MM LT 1
  ADD 12 TO #MONTH-KEY-MM
  SUBTRACT 1 FROM #MONTH-KEY-YYYY
END-IF
*
FIND MS-V WITH MONTH-KEY = #MONTH-KEY  /* last month record
  FOR #I1 1 TO 12
    ADD ME-AFSC-BY-PLAN (#I1) TO #AFSC-BEG-MONTH
  END-FOR
*
  MOVE ME-AFSC-AAFM-TOTS (1) TO #AAFMAA-GF-BEG-MONTH /* lst mon G/F
  MOVE ME-AFSC-AAFM-TOTS (4) TO #AAFMAA-LST-MON-PL  /* lst mon p/l
* MOVE ME-AFSC-AAFM-DOD-CURR-YR-GF TO #LAST-MON-DOD-CURR-YR-GF
* MOVE ME-AFSC-AAFM-DOD-CURR-YR-IO TO #LAST-MON-DOD-CURR-YR-IO
*
* CALC LAST MONTHS PROJECTION AMT
  IF ME-AFSC-AAFM-DOD-CURR-YR-PRJ-GF GT ME-AFSC-AAFM-WIDS-SERVED-GF
    MOVE ME-AFSC-AAFM-WIDS-SERVED-GF TO ME-AFSC-AAFM-DOD-CURR-YR-PRJ-GF
*     IF #CGA-CLERK = 'PAM'
*       WRITE 'RESET PROJ GF DEATHS'
*     END-IF
  END-IF
*
  IF ME-AFSC-AAFM-DOD-CURR-YR-PRJ-IO GT ME-AFSC-AAFM-WIDS-SERVED-IO
    MOVE ME-AFSC-AAFM-WIDS-SERVED-IO TO ME-AFSC-AAFM-DOD-CURR-YR-PRJ-IO
*     IF #CGA-CLERK = 'PAM'
*       WRITE 'RESET PROJ IO DEATHS'
*     END-IF
  END-IF
*
  MOVE #RQST-YYYYMM-LAST TO #USED-DATE
  PERFORM USE-CURR-RATES
* WRITE '4890' #GF-MON-RATE #RQST-YYYYMM-LAST
*
  COMPUTE #AFSC-NXT-MON-BILLABLE-GF = ME-AFSC-AAFM-WIDS-SERVED-GF
    - ME-AFSC-AAFM-DOD-CURR-YR-PRJ-GF
  COMPUTE #AFSC-NXT-MON-BILLABLE-IO = ME-AFSC-AAFM-WIDS-SERVED-IO
    - ME-AFSC-AAFM-DOD-CURR-YR-PRJ-IO
*
  COMPUTE #ADJ-BILL-GF-MONTHLY = ME-AFSC-AAFM-TOTS (1) * #GF-MON-RATE
  COMPUTE #ADJ-BILL-PL-MONTHLY = ME-AFSC-AAFM-TOTS (4) * #PL-MON-RATE
  COMPUTE #ADJ-BILL-GF-WIDS-MONTHLY
    = #AFSC-NXT-MON-BILLABLE-GF  * #GF-WID-MON-RATE
  COMPUTE #ADJ-BILL-IO-WIDS-MONTHLY
    = #AFSC-NXT-MON-BILLABLE-IO * #IO-WID-MON-RATE
  COMPUTE #ADJ-BILL-GF-DEATHS  = #ADJ-GF-DETHS  * #GW-DEATH-RATE
  COMPUTE #ADJ-BILL-OTH-DEATHS = #ADJ-OTH-DETHS * #GN-DEATH-RATE
  COMPUTE #ADJ-TOT-BILL = #ADJ-BILL-GF-MONTHLY
    + #ADJ-BILL-PL-MONTHLY
    + #ADJ-BILL-GF-WIDS-MONTHLY
    + #ADJ-BILL-IO-WIDS-MONTHLY
    + #ADJ-BILL-GF-DEATHS
    + #ADJ-BILL-OTH-DEATHS
END-FIND
*
*   get CURR month recoed
MOVE #RQST-YYYYMM TO #MONTH-KEY
FIND MS-V WITH MONTH-KEY = #MONTH-KEY  /* read current rec
  MOVE ME-AFSC-AAFM-WIDS-SERVED-GF TO #AFSC-LAST-MON-WIDS-SERVED-GF
  MOVE ME-AFSC-AAFM-WIDS-SERVED-IO TO #AFSC-LAST-MON-WIDS-SERVED-IO
*
  FOR #I1 1 TO 12
    ADD MTD-AFSC-GAINS-BY-PLAN (#I1) TO #TOT-MTD-AFSC-GAINS
  END-FOR
*
  FOR #I1 1 TO 2
    ADD MTD-AFSC-LOSSES-BY-TYPE (#I1) TO #TOT-MTD-AFSC-LOSSES
  END-FOR
*
  COMPUTE #AFSC-TOT-GAINS = ME-AFSC-GAINS-P-L + ME-AFSC-GAINS-COMBO
    + ME-AFSC-GAINS-S-O
  COMPUTE #AFSC-TOT-LOSSES = ME-AFSC-LOSSES-P-L + ME-AFSC-LOSSES-COMBO
    + ME-AFSC-LOSSES-S-O
  COMPUTE #AFSC-END-MONTH = #AFSC-BEG-MONTH + #AFSC-TOT-GAINS
    - #AFSC-TOT-LOSSES
  FOR #I1 1 TO 4                                                 /* PM8
    ADD ME-AFSC-AAFM-TOTS (#I1) TO #AAFMAA-END-MONTH
  END-FOR
*
  FOR #I1 1 TO 6
    ADD ME-AFSC-AAFM-DEATHS (#I1) TO #AAFMAA-TOT-DEATHS
  END-FOR
  ADD ME-AFSC-AAFM-DEATHS (2:5) TO #OTH-DEATHS-CURR
*
  COMPUTE #AAFMAA-TOT-WIDOWS = ME-AFSC-AAFM-WIDS-SERVED
    + ME-AFSC-AAFM-WIDS-NOT-SERVED
  COMPUTE #AFSC-TOT-WIDOWS = ME-AFSC-WIDS-SERVED
    + ME-AFSC-WIDS-NOT-SERVED
*
  IF ME-AFSC-AAFM-DOD-CURR-YR-GF GT #AFSC-LAST-MON-WIDS-SERVED-GF
    MOVE #AFSC-LAST-MON-WIDS-SERVED-GF TO ME-AFSC-AAFM-DOD-CURR-YR-GF
*     IF #CGA-CLERK = 'PAM'
*       WRITE 'RESET CURR GF DEATHS'
*     END-IF
  END-IF
*
  IF ME-AFSC-AAFM-DOD-CURR-YR-IO GT #AFSC-LAST-MON-WIDS-SERVED-IO
    MOVE #AFSC-LAST-MON-WIDS-SERVED-IO TO ME-AFSC-AAFM-DOD-CURR-YR-IO
*     IF #CGA-CLERK = 'PAM'
*       WRITE 'RESET CURR GF DEATHS'
*     END-IF
  END-IF
*
*
  COMPUTE #AFSC-CURR-BILLABLE-GF = #AFSC-LAST-MON-WIDS-SERVED-GF
*                             - #LAST-MON-DOD-CURR-YR-GF
    - ME-AFSC-AAFM-DOD-CURR-YR-GF
  COMPUTE #AFSC-CURR-BILLABLE-IO = #AFSC-LAST-MON-WIDS-SERVED-IO
*                             - #LAST-MON-DOD-CURR-YR-IO
    - ME-AFSC-AAFM-DOD-CURR-YR-IO
  MOVE #RQST-YYYYMM-CURR TO #USED-DATE
  PERFORM USE-CURR-RATES
*
* WRITE '5760' #GF-MON-RATE #RQST-YYYYMM-CURR
*
  #PSM-PLANS   := me-psm-plans          /* NG1
  #PSM-GAINS   := me-psm-plans          /* NG1
  #PSM-LOSSES  := me-psm-losses         /* NG1
  #PSM-AMOUNT  := me-psm-amount         /* NG1
*
  COMPUTE #BILL-GF-MONTHLY = #AAFMAA-GF-BEG-MONTH   * #GF-MON-RATE
  COMPUTE #BILL-PL-MONTHLY = #AAFMAA-LST-MON-PL     * #PL-MON-RATE
  COMPUTE #BILL-GF-WIDS-MONTHLY
    = #AFSC-CURR-BILLABLE-GF * #GF-WID-MON-RATE
  COMPUTE #BILL-IO-WIDS-MONTHLY
    = #AFSC-CURR-BILLABLE-IO * #IO-WID-MON-RATE
  COMPUTE #BILL-GF-DEATHS = ME-AFSC-AAFM-DEATHS (1) * #GW-DEATH-RATE
  COMPUTE #BILL-OTH-DEATHS = #OTH-DEATHS-CURR       * #GN-DEATH-RATE
  COMPUTE #BILL-WID-CRED-OVR90 =
    ME-AFSC-WID-DETHS-MONS-OVR90-GF * #GF-WID-MON-RATE
  COMPUTE #BILL-WID-CRED-UND90 =
    ME-AFSC-WID-DETHS-MONS-UND90-GF * #GF-WID-MON-RATE * .50
  COMPUTE #SUB-TOT-BILL = #BILL-GF-MONTHLY
    + #BILL-GF-WIDS-MONTHLY
    + #BILL-IO-WIDS-MONTHLY
    + #BILL-GF-DEATHS
    + #BILL-OTH-DEATHS
    - #BILL-WID-CRED-UND90
    - #BILL-WID-CRED-OVR90
  COMPUTE #TOT-BILL = #SUB-TOT-BILL
    + #BILL-PL-MONTHLY + #PSM-AMOUNT     /* NG1
*
  COMPUTE #AFSC-NXT-MON-BILLABLE-GF = ME-AFSC-AAFM-WIDS-SERVED-GF
    - ME-AFSC-AAFM-DOD-CURR-YR-PRJ-GF
  COMPUTE #AFSC-NXT-MON-BILLABLE-IO = ME-AFSC-AAFM-WIDS-SERVED-IO
    - ME-AFSC-AAFM-DOD-CURR-YR-PRJ-IO
  MOVE #RQST-YYYYMM-NEXT TO #USED-DATE
  PERFORM USE-CURR-RATES
*
* WRITE '6300' #GF-MON-RATE #RQST-YYYYMM-NEXT
*
  COMPUTE #NXT-BILL-GF-MONTHLY = ME-AFSC-AAFM-TOTS (1) * #GF-MON-RATE
  COMPUTE #NXT-BILL-PL-MONTHLY = ME-AFSC-AAFM-TOTS (4) * #PL-MON-RATE
  COMPUTE #NXT-BILL-GF-WIDS-MONTHLY
    = #AFSC-NXT-MON-BILLABLE-GF  * #GF-WID-MON-RATE
  COMPUTE #NXT-BILL-IO-WIDS-MONTHLY
    = #AFSC-NXT-MON-BILLABLE-IO * #IO-WID-MON-RATE
  COMPUTE #NXT-BILL-GF-DEATHS  = #PROJ-GF-DETHS  * #GW-DEATH-RATE
  COMPUTE #NXT-BILL-OTH-DEATHS = #PROJ-OTH-DETHS * #GN-DEATH-RATE
  COMPUTE #NXT-SUB-TOT-BILL = #NXT-BILL-GF-MONTHLY
    + #NXT-BILL-GF-WIDS-MONTHLY
    + #NXT-BILL-IO-WIDS-MONTHLY
    + #NXT-BILL-GF-DEATHS
    + #NXT-BILL-OTH-DEATHS
  COMPUTE #NXT-TOT-BILL = #NXT-SUB-TOT-BILL
    + #NXT-BILL-PL-MONTHLY
END-FIND
*
IF #RQST-YYYYMM GE 200007
  COMPUTE #ADJUSTMENT = #TOT-BILL - #ADJ-TOT-BILL
END-IF
*
COMPUTE #FINAL-BILL = #NXT-TOT-BILL + #ADJUSTMENT
*
IF ME-AFSC-AAFM-I-P-B4 (3) = 0 /* will ne zero prior to 5/2002
  MOVE ME-AFSC-AAFM-TOTS (2) TO ME-AFSC-AAFM-I-P-B4 (3)
END-IF
*
COMPUTE #AAFMAA-PL-LOSS = #AAFMAA-LST-MON-PL - ME-AFSC-AAFM-TOTS (4)
COMPUTE #TOT-SPECIAL-CLIENTS =
  (AER-CLIENTS + NMCRS-CLIENTS + AFAS-CLIENTS + CGMA-CLIENTS
  + UWSF-CLIENTS)
COMPUTE #LIFETIME-MBRS-NON-SPC-CLIENTS =     /* DW3
  ME-AFSC-LIFETIME-MBRS - #TOT-SPECIAL-CLIENTS
*
MOVE '*' TO #CGA-SCR-COMMAND
*
REPEAT
*
  IF #CGA-USER-COMPANY NE 'I'   /* AAFMAA cannot see these   DW7   PM8
    IF #RQST-YYYYMM GE 200011
      CALLNAT 'S4113SMS'
    END-IF
  END-IF                                                    /* DW7  PM8
*
  MOVE 'Press ENTER to see Widow Stats' TO #TEXT
*  IF #CGA-USER-COMPANY = 'S'                             /* DW7
*    INPUT TEXT #TEXT USING MAP 'G4151MMS' /* AFSC has some info blanked
*  ELSE
  INPUT TEXT #TEXT USING MAP 'G4149MMS'  /* all info is here
*  END-IF
*
  IF #CGA-SCR-COMMAND NE '*'
    ESCAPE BOTTOM
  END-IF
*
  MOVE 'Press ENTER to see AFA Billing Invoice' TO  #TEXT        /* RE1
  INPUT TEXT #TEXT USING MAP 'G4150MMS'
*
  IF #CGA-SCR-COMMAND NE '*'
    ESCAPE BOTTOM
  END-IF
  MOVE #RQST-YYYYMM-CURR TO #USED-DATE
  PERFORM USE-CURR-RATES
*
* WRITE '7270' #GF-MON-RATE #RQST-YYYYMM-CURR
*
*  IF (#CGA-USER-COMPANY = 'S'                                /* DW7
*   AND NOT (#CGA-CLERK = 'KRM' OR = 'BJS' OR = 'JKM'))
*    IGNORE
*  ELSE
  MOVE 'Press ENTER to see AFA Next Month Projected Billing Invoice'    /* RE1
    TO #TEXT
  INPUT TEXT #TEXT USING MAP 'G4142MMS'   /* CURRENT INVOICE
*
  IF #CGA-SCR-COMMAND NE '*'
    ESCAPE BOTTOM
  END-IF
  MOVE #RQST-YYYYMM-NEXT TO #USED-DATE
  PERFORM USE-CURR-RATES
*
* WRITE '7620' #GF-MON-RATE #RQST-YYYYMM-NEXT
*
  MOVE 'Press ENTER to see cycle thru again' TO  #TEXT
*
* IF #RQST-YYYYMM LT 200107
  INPUT TEXT #TEXT USING MAP 'G4147MMS' /* with no adj lines at bottom
* ELSE
*   INPUT TEXT #TEXT USING MAP 'G4143MMS' /* mxt mon proj
*  END-IF
* END-IF
*
  IF #CGA-SCR-COMMAND NE '*'
    ESCAPE BOTTOM
  END-IF
END-REPEAT
*
FETCH 'G1000PXX'
*
* * * * * * * * * * * * * * *
DEFINE SUBROUTINE PROJ-6-MONS
* * * * * * * * * * * * * * *
*
IF  (#CGA-SCR-SUFFIX NE '6MO')
    OR (#RQST-YYYYMM LT 200012)
  ESCAPE ROUTINE
END-IF
*
* WRITE / 'PRESS ENTER TO CONTINUE' /
*
IF #RQST-YYYYMM LE 200105
  MOVE 200012 TO #END-YYYYMM  /* end month for doing projection
ELSE
  IF #RQST-YYYYMM LE 200111
    MOVE 200106 TO #END-YYYYMM  /* end month for doing projection
  END-IF
END-IF
*
MOVE 200006 TO #YYYYMM    /* start month
*
REPEAT
  FIND (1) MS-V WITH MONTH-KEY = #YYYYMM
    COMPUTE #WS = #LAST-WS - ME-AFSC-AAFM-DOD-CURR-YR-GF
    IF #CGA-CLERK = 'VXT'                       /* vt2
      DISPLAY 'MONTH' #YYYYMM
        'G-F/(GF)' ME-AFSC-AAFM-TOTS (1)
        'P-L/(PL)' ME-AFSC-AAFM-TOTS (4)
        'WIDS-SERVED/(WS)' ME-AFSC-AAFM-WIDS-SERVED-GF
        'last-ws'             #LAST-WS
        'DIED-CURR/YEAR (DC)' ME-AFSC-AAFM-DOD-CURR-YR-GF
        'Wids/served'         #WS
    END-IF
*
    IF #YYYYMM = 200006   /* 1ST MONTH
      MOVE ME-AFSC-AAFM-TOTS (1)    TO #6MO-BEG-GF
      MOVE ME-AFSC-AAFM-TOTS (4)    TO #6MO-BEG-PL
    ELSE
      IF #YYYYMM NE #END-YYYYMM
        ADD 1 TO #6MO-MONS
      END-IF
    END-IF
*
    IF #YYYYMM = 200007   /* 2nd MONTH
      COMPUTE #6MO-BEG-WS = #LAST-WS - ME-AFSC-AAFM-DOD-CURR-YR-GF
    END-IF
*
    IF #YYYYMM = #END-YYYYMM
      COMPUTE #6MO-END-WS = #LAST-WS - ME-AFSC-AAFM-DOD-CURR-YR-GF
    ELSE
      MOVE ME-AFSC-AAFM-TOTS (1)       TO #6MO-END-GF
      MOVE ME-AFSC-AAFM-TOTS (4)       TO #6MO-END-PL
    END-IF
  END-FIND
*
  IF #YYYYMM GE #END-YYYYMM
    ESCAPE BOTTOM
  END-IF
*
  MOVE ME-AFSC-AAFM-WIDS-SERVED-GF TO #LAST-WS
*
  ADD 1 TO #MM
  IF #MM GT 12
    SUBTRACT 12 FROM #MM
    ADD 1 TO #YYYY
  END-IF
END-REPEAT
*
COMPUTE ROUNDED #6MO-PCT-GF =    /* assumes is decreasing
  ((#6MO-BEG-GF - #6MO-END-GF) / #6MO-BEG-GF) / #6MO-MONS
MOVE .01 TO  #6MO-PCT-PL
COMPUTE ROUNDED #6MO-PCT-WS =    /* assumes is decreasing
  ((#6MO-BEG-WS - #6MO-END-WS) / #6MO-BEG-WS) / #6MO-MONS
*
IF #CGA-CLERK = 'VXT'                         /* vt2
  WRITE '     PCT       BEG    END     MONS'
  WRITE 'GF' #6MO-PCT-GF  #6MO-BEG-GF  #6MO-END-GF #6MO-MONS
  WRITE 'PL' #6MO-PCT-PL  #6MO-BEG-PL  #6MO-END-PL #6MO-MONS
  WRITE 'WS' #6MO-PCT-WS  #6MO-BEG-WS  #6MO-END-WS #6MO-MONS
  WRITE 'AVG G/F DEATHS WITH WIDOW' #ADJ-GF-DETHS
  WRITE 'AVG G/F DEATHS W/O WIDOW' #ADJ-OTH-DETHS
END-IF
*
MOVE #6MO-END-GF TO #6MO-NXT-GF
MOVE #6MO-END-PL TO #6MO-NXT-PL
MOVE #6MO-END-WS TO #6MO-NXT-WS
*
ADD 1 TO #MM   /* TO BUMT TO STARTING POINT
IF #MM GT 12
  SUBTRACT 12 FROM #MM
  ADD 1 TO #YYYY
END-IF
MOVE #RQST-YYYYMM-CURR TO #USED-DATE
PERFORM USE-CURR-RATES
*
IF #RQST-YYYYMM-CURR LT 200105 /* doing 01/2001 thru 6/2001
  MOVE #GF-MON-RATE-00     TO #GF-MON-RATE
  MOVE #PL-MON-RATE-00     TO #PL-MON-RATE
  MOVE #GF-WID-MON-RATE-00 TO #GF-WID-MON-RATE
  MOVE #IO-WID-MON-RATE-00 TO #IO-WID-MON-RATE
  MOVE #GW-DEATH-RATE-00   TO #GW-DEATH-RATE
  MOVE #GN-DEATH-RATE-00   TO #GN-DEATH-RATE
ELSE
  IF #RQST-YYYYMM-CURR LT 200205   /* 7/2001 THRU 6/2002
    MOVE #GF-MON-RATE-01     TO #GF-MON-RATE
    MOVE #PL-MON-RATE-01     TO #PL-MON-RATE
    MOVE #GF-WID-MON-RATE-01 TO #GF-WID-MON-RATE
    MOVE #IO-WID-MON-RATE-01 TO #IO-WID-MON-RATE
    MOVE #GW-DEATH-RATE-01   TO #GW-DEATH-RATE
    MOVE #GN-DEATH-RATE-01   TO #GN-DEATH-RATE
  ELSE
    IF #RQST-YYYYMM-CURR LT 200305  /* 7/2002 THRU 6/2003
      IF #RQST-YYYYMM-CURR LT 200210  /* 7/2002 THRU 6/2003
        MOVE #GF-MON-RATE-02     TO #GF-MON-RATE
      ELSE
        MOVE #GF-MON-RATE-02-B   TO #GF-MON-RATE
      END-IF
*
      MOVE #PL-MON-RATE-02     TO #PL-MON-RATE
      MOVE #GF-WID-MON-RATE-02 TO #GF-WID-MON-RATE
      MOVE #IO-WID-MON-RATE-02 TO #IO-WID-MON-RATE
      MOVE #GW-DEATH-RATE-02   TO #GW-DEATH-RATE
      MOVE #GN-DEATH-RATE-02   TO #GN-DEATH-RATE
    ELSE
      IF #RQST-YYYYMM-CURR LT 200405   /* 7/2003 THRU 6/2004
        MOVE #GF-MON-RATE-03     TO #GF-MON-RATE
        MOVE #PL-MON-RATE-03     TO #PL-MON-RATE
        MOVE #GF-WID-MON-RATE-03 TO #GF-WID-MON-RATE
        MOVE #IO-WID-MON-RATE-03 TO #IO-WID-MON-RATE
        MOVE #GW-DEATH-RATE-03   TO #GW-DEATH-RATE
        MOVE #GN-DEATH-RATE-03   TO #GN-DEATH-RATE
      ELSE
        IF #RQST-YYYYMM-CURR LT 200505   /* 7/2004 THRU 6/2005
          MOVE #GF-MON-RATE-04     TO #GF-MON-RATE
          MOVE #PL-MON-RATE-04     TO #PL-MON-RATE
          MOVE #GF-WID-MON-RATE-04 TO #GF-WID-MON-RATE
          MOVE #IO-WID-MON-RATE-04 TO #IO-WID-MON-RATE
          MOVE #GW-DEATH-RATE-04   TO #GW-DEATH-RATE
          MOVE #GN-DEATH-RATE-04   TO #GN-DEATH-RATE
        ELSE
          IF #RQST-YYYYMM-CURR LT 200605   /* 7/2005 THRU 6/2006  /* DW1
            MOVE #GF-MON-RATE-05     TO #GF-MON-RATE
            MOVE #PL-MON-RATE-05     TO #PL-MON-RATE
            MOVE #GF-WID-MON-RATE-05 TO #GF-WID-MON-RATE
            MOVE #IO-WID-MON-RATE-05 TO #IO-WID-MON-RATE
            MOVE #GW-DEATH-RATE-05   TO #GW-DEATH-RATE
            MOVE #GN-DEATH-RATE-05   TO #GN-DEATH-RATE
          ELSE
            IF #RQST-YYYYMM-CURR LT 200705 /* 7/2006 THRU 6/2007  /* DW2
              MOVE #GF-MON-RATE-06     TO #GF-MON-RATE
              MOVE #PL-MON-RATE-06     TO #PL-MON-RATE
              MOVE #GF-WID-MON-RATE-06 TO #GF-WID-MON-RATE
              MOVE #IO-WID-MON-RATE-06 TO #IO-WID-MON-RATE
              MOVE #GW-DEATH-RATE-06   TO #GW-DEATH-RATE
              MOVE #GN-DEATH-RATE-06   TO #GN-DEATH-RATE
            ELSE
              IF #RQST-YYYYMM-CURR LT 200805 /* 7/2007 THRU 6/2008  /* DW4
                MOVE #GF-MON-RATE-07     TO #GF-MON-RATE
                MOVE #PL-MON-RATE-07     TO #PL-MON-RATE
                MOVE #GF-WID-MON-RATE-07 TO #GF-WID-MON-RATE
                MOVE #IO-WID-MON-RATE-07 TO #IO-WID-MON-RATE
                MOVE #GW-DEATH-RATE-07   TO #GW-DEATH-RATE
                MOVE #GN-DEATH-RATE-07   TO #GN-DEATH-RATE
              ELSE
                IF #RQST-YYYYMM-CURR LT 200905 /* 7/2008 THRU 6/2009 /*DW5
                  MOVE #GF-MON-RATE-08     TO #GF-MON-RATE
                  MOVE #PL-MON-RATE-08     TO #PL-MON-RATE
                  MOVE #GF-WID-MON-RATE-08 TO #GF-WID-MON-RATE
                  MOVE #IO-WID-MON-RATE-08 TO #IO-WID-MON-RATE
                  MOVE #GW-DEATH-RATE-08   TO #GW-DEATH-RATE
                  MOVE #GN-DEATH-RATE-08   TO #GN-DEATH-RATE
                ELSE
                  IF #RQST-YYYYMM-CURR LT 201005 /* 7/2009 THRU 6/2010 /*DW6
                      OR (#RQST-YYYYMM-CURR GE 201005 /* ONLY ON LAST ONE  /*DW6 vt1
                      and #rqst-yyyymm-curr lt 201201)                     /* vt1
                    MOVE #GF-MON-RATE-09      TO #GF-MON-RATE
                    MOVE #PL-MON-RATE-09     TO #PL-MON-RATE
                    MOVE #GF-WID-MON-RATE-09 TO #GF-WID-MON-RATE
                    MOVE #IO-WID-MON-RATE-09 TO #IO-WID-MON-RATE
                    MOVE #GW-DEATH-RATE-09   TO #GW-DEATH-RATE
                    MOVE #GN-DEATH-RATE-09   TO #GN-DEATH-RATE
                  else                                                  /* vt1 \/
                    if #RQST-YYYYMM-CURR ge 201201
                        and #rqst-yyyymm-curr lt 201301
                      MOVE #GF-MON-RATE-10      TO #GF-MON-RATE
                      MOVE #PL-MON-RATE-10     TO #PL-MON-RATE
                      MOVE #GF-WID-MON-RATE-10 TO #GF-WID-MON-RATE
                      MOVE #IO-WID-MON-RATE-10 TO #IO-WID-MON-RATE
                      MOVE #GW-DEATH-RATE-10   TO #GW-DEATH-RATE
                      MOVE #GN-DEATH-RATE-10   TO #GN-DEATH-RATE
                    else
                      if #RQST-YYYYMM-CURR ge 201301
                          and #RQST-YYYYMM-CURR lt 201401                                      /* vt4
                        MOVE #GF-MON-RATE-11     TO #GF-MON-RATE
                        MOVE #PL-MON-RATE-11    TO #PL-MON-RATE
                        MOVE #GF-WID-MON-RATE-11 TO #GF-WID-MON-RATE
                        MOVE #IO-WID-MON-RATE-11 TO #IO-WID-MON-RATE
                        MOVE #GW-DEATH-RATE-11   TO #GW-DEATH-RATE
                        MOVE #GN-DEATH-RATE-11   TO #GN-DEATH-RATE
*                      end-if                                                           /* vt3 /\
                      else                                                          /* vt4 \/
                        if #RQST-YYYYMM-CURR ge 201401
                            and #RQST-YYYYMM-CURR lt 201501
                          MOVE #GF-MON-RATE-12    TO #GF-MON-RATE
                          MOVE #PL-MON-RATE-12    TO #PL-MON-RATE
                          MOVE #GF-WID-MON-RATE-12 TO #GF-WID-MON-RATE
                          MOVE #IO-WID-MON-RATE-12 TO #IO-WID-MON-RATE
                          MOVE #GW-DEATH-RATE-12   TO #GW-DEATH-RATE
                          MOVE #GN-DEATH-RATE-12   TO #GN-DEATH-RATE
                        else                                                               /* vt5 \/
                          if #RQST-YYYYMM-CURR ge 201501
                              and #rqst-yyyymm-curr lt 201701                                 /* vt6
                            MOVE #GF-MON-RATE-13    TO #GF-MON-RATE
                            MOVE #PL-MON-RATE-13    TO #PL-MON-RATE
                            MOVE #GF-WID-MON-RATE-13 TO #GF-WID-MON-RATE
                            MOVE #IO-WID-MON-RATE-13 TO #IO-WID-MON-RATE
                            MOVE #GW-DEATH-RATE-13   TO #GW-DEATH-RATE
                            MOVE #GN-DEATH-RATE-13   TO #GN-DEATH-RATE                    /* vt5 /\
                          else                                                               /* vt6 \/
                            if #RQST-YYYYMM-CURR ge 201701
                                and #rqst-yyyymm-curr lt 201801                                 /* vt7
                              MOVE #GF-MON-RATE-14    TO #GF-MON-RATE
                              MOVE #PL-MON-RATE-14    TO #PL-MON-RATE
                              MOVE #GF-WID-MON-RATE-14 TO #GF-WID-MON-RATE
                              MOVE #IO-WID-MON-RATE-14 TO #IO-WID-MON-RATE
                              MOVE #GW-DEATH-RATE-14   TO #GW-DEATH-RATE
                              MOVE #GN-DEATH-RATE-14   TO #GN-DEATH-RATE                    /* vt65 /\
                            else                                                            /* vt7 \/
                              if #RQST-YYYYMM-CURR ge 201801
                                MOVE #GF-MON-RATE-15     TO #GF-MON-RATE
                                MOVE #PL-MON-RATE-15     TO #PL-MON-RATE
                                MOVE #GF-WID-MON-RATE-15 TO #GF-WID-MON-RATE
                                MOVE #IO-WID-MON-RATE-15 TO #IO-WID-MON-RATE
                                MOVE #GW-DEATH-RATE-15   TO #GW-DEATH-RATE
                                MOVE #GN-DEATH-RATE-15   TO #GN-DEATH-RATE
                              end-if                                                        /* vt7 /\
                            end-if
                          end-if
                        end-if
                      end-if
                    end-if               /* vt1 /\
                  END-IF
                END-IF
              END-IF
            END-IF
          END-IF
        END-IF
      END-IF
    END-IF
  END-IF
END-IF
* WRITE '8960'  #AAFMAA-GF-BEG-MONTH #GF-MON-RATE #RQST-YYYYMM-CURR
*
FOR #I1 1 TO 6
  COMPUTE #6MO-NXT-GF = #6MO-NXT-GF - (#6MO-NXT-GF * #6MO-PCT-GF)
  COMPUTE #6MO-NXT-PL = #6MO-NXT-PL - (#6MO-NXT-PL * #6MO-PCT-PL)
  COMPUTE #6MO-NXT-WS = #6MO-NXT-WS - (#6MO-NXT-WS * #6MO-PCT-WS)
*
  IF #YYYYMM GT #END-YYYYMM
    COMPUTE #6MO-GF-BILL = #6MO-NXT-GF * #GF-MON-RATE
    COMPUTE #6MO-PL-BILL = #6MO-NXT-PL * #PL-MON-RATE
    COMPUTE #6MO-WS-BILL = #6MO-NXT-WS * #GF-WID-MON-RATE
    COMPUTE #6MO-GW-BILL = #ADJ-GF-DETHS  * #GW-DEATH-RATE
    COMPUTE #6MO-OT-BILL = #ADJ-OTH-DETHS * #GN-DEATH-RATE
    COMPUTE #6MO-TOT-BILL = #6MO-GF-BILL
      + #6MO-PL-BILL
      + #6MO-WS-BILL
      + #6MO-GW-BILL
      + #6MO-OT-BILL
    ADD #6MO-NXT-GF TO #6MO-TOT-GF
    ADD #6MO-NXT-PL TO #6MO-TOT-PL
    ADD #6MO-NXT-WS TO #6MO-TOT-WS
    ADD #PROJ-GF-DETHS TO #6MO-TOT-GW
    ADD #PROJ-OTH-DETHS TO #6MO-TOT-OT
*
    INPUT USING MAP 'G4146MMS'
*
    IF #CGA-SCR-COMMAND NE '*'
      ESCAPE ROUTINE
    END-IF
*
    ADD #6MO-GF-BILL TO #6MO-GF-BILL-TOT
    ADD #6MO-PL-BILL TO #6MO-PL-BILL-TOT
    ADD #6MO-WS-BILL TO #6MO-WS-BILL-TOT
    ADD #6MO-GW-BILL TO #6MO-GW-BILL-TOT
    ADD #6MO-OT-BILL TO #6MO-OT-BILL-TOT
  END-IF
*
  ADD 1 TO #MM
  IF #MM GT 12
    SUBTRACT 12 FROM #MM
    ADD 1 TO #YYYY
  END-IF
END-FOR
*
COMPUTE #6MO-TOT-BILL-TOT = #6MO-GF-BILL-TOT
  + #6MO-PL-BILL-TOT
  + #6MO-WS-BILL-TOT
  + #6MO-GW-BILL-TOT
  + #6MO-OT-BILL-TOT
*
INPUT USING MAP 'G4145MMS'
*
END-SUBROUTINE
*
* * * * * * * * * * * * * * * * *
DEFINE SUBROUTINE USE-CURR-RATES
* * * * * * * * * * * * * * * * *
*
* write '=' #used-date
IF #USED-DATE LT 200107
  MOVE #GF-MON-RATE-00     TO #GF-MON-RATE
  MOVE #PL-MON-RATE-00     TO #PL-MON-RATE
  MOVE #GF-WID-MON-RATE-00 TO #GF-WID-MON-RATE
  MOVE #IO-WID-MON-RATE-00 TO #IO-WID-MON-RATE
  MOVE #GW-DEATH-RATE-00   TO #GW-DEATH-RATE
  MOVE #GN-DEATH-RATE-00   TO #GN-DEATH-RATE
ELSE
  IF #USED-DATE LT 200207
    MOVE #GF-MON-RATE-01     TO #GF-MON-RATE
    MOVE #PL-MON-RATE-01     TO #PL-MON-RATE
    MOVE #GF-WID-MON-RATE-01 TO #GF-WID-MON-RATE
    MOVE #IO-WID-MON-RATE-01 TO #IO-WID-MON-RATE
    MOVE #GW-DEATH-RATE-01   TO #GW-DEATH-RATE
    MOVE #GN-DEATH-RATE-01   TO #GN-DEATH-RATE
  ELSE
    IF #USED-DATE LT 200307
      IF #USED-DATE LT 200210
        MOVE #GF-MON-RATE-02     TO #GF-MON-RATE
      ELSE
        MOVE #GF-MON-RATE-02-B   TO #GF-MON-RATE
      END-IF
*
      MOVE #PL-MON-RATE-02     TO #PL-MON-RATE
      MOVE #GF-WID-MON-RATE-02 TO #GF-WID-MON-RATE
      MOVE #IO-WID-MON-RATE-02 TO #IO-WID-MON-RATE
      MOVE #GW-DEATH-RATE-02   TO #GW-DEATH-RATE
      MOVE #GN-DEATH-RATE-02   TO #GN-DEATH-RATE
    ELSE
      IF #USED-DATE LT 200407
        MOVE #GF-MON-RATE-03     TO #GF-MON-RATE
        MOVE #PL-MON-RATE-03     TO #PL-MON-RATE
        MOVE #GF-WID-MON-RATE-03 TO #GF-WID-MON-RATE
        MOVE #IO-WID-MON-RATE-03 TO #IO-WID-MON-RATE
        MOVE #GW-DEATH-RATE-03   TO #GW-DEATH-RATE
        MOVE #GN-DEATH-RATE-03   TO #GN-DEATH-RATE
      ELSE
        IF #USED-DATE LT 200507
          MOVE #GF-MON-RATE-04     TO #GF-MON-RATE
          MOVE #PL-MON-RATE-04     TO #PL-MON-RATE
          MOVE #GF-WID-MON-RATE-04 TO #GF-WID-MON-RATE
          MOVE #IO-WID-MON-RATE-04 TO #IO-WID-MON-RATE
          MOVE #GW-DEATH-RATE-04   TO #GW-DEATH-RATE
          MOVE #GN-DEATH-RATE-04   TO #GN-DEATH-RATE
        ELSE
          IF #USED-DATE LT 200607                           /* DW1
            MOVE #GF-MON-RATE-05     TO #GF-MON-RATE
            MOVE #PL-MON-RATE-05     TO #PL-MON-RATE
            MOVE #GF-WID-MON-RATE-05 TO #GF-WID-MON-RATE
            MOVE #IO-WID-MON-RATE-05 TO #IO-WID-MON-RATE
            MOVE #GW-DEATH-RATE-05   TO #GW-DEATH-RATE
            MOVE #GN-DEATH-RATE-05   TO #GN-DEATH-RATE
          ELSE
            IF #USED-DATE LT 200707                        /* DW2
              MOVE #GF-MON-RATE-06     TO #GF-MON-RATE
              MOVE #PL-MON-RATE-06     TO #PL-MON-RATE
              MOVE #GF-WID-MON-RATE-06 TO #GF-WID-MON-RATE
              MOVE #IO-WID-MON-RATE-06 TO #IO-WID-MON-RATE
              MOVE #GW-DEATH-RATE-06   TO #GW-DEATH-RATE
              MOVE #GN-DEATH-RATE-06   TO #GN-DEATH-RATE
            ELSE
              IF #USED-DATE LT 200807                        /* DW4
                MOVE #GF-MON-RATE-07     TO #GF-MON-RATE
                MOVE #PL-MON-RATE-07     TO #PL-MON-RATE
                MOVE #GF-WID-MON-RATE-07 TO #GF-WID-MON-RATE
                MOVE #IO-WID-MON-RATE-07 TO #IO-WID-MON-RATE
                MOVE #GW-DEATH-RATE-07   TO #GW-DEATH-RATE
                MOVE #GN-DEATH-RATE-07   TO #GN-DEATH-RATE
              ELSE
                IF #USED-DATE LT 200907                        /* DW5
                  MOVE #GF-MON-RATE-08     TO #GF-MON-RATE
                  MOVE #PL-MON-RATE-08     TO #PL-MON-RATE
                  MOVE #GF-WID-MON-RATE-08 TO #GF-WID-MON-RATE
                  MOVE #IO-WID-MON-RATE-08 TO #IO-WID-MON-RATE
                  MOVE #GW-DEATH-RATE-08   TO #GW-DEATH-RATE
                  MOVE #GN-DEATH-RATE-08   TO #GN-DEATH-RATE
                ELSE
                  IF #USED-DATE LT 201007                        /* DW6
                      OR (#USED-DATE GE 201007 /* ONLY ON LAST ONE   /* DW6   vt1
                      and #used-date lt 201201)                     /*       vt1
                    MOVE #GF-MON-RATE-09     TO #GF-MON-RATE
                    MOVE #PL-MON-RATE-09     TO #PL-MON-RATE
                    MOVE #GF-WID-MON-RATE-09 TO #GF-WID-MON-RATE
                    MOVE #IO-WID-MON-RATE-09 TO #IO-WID-MON-RATE
                    MOVE #GW-DEATH-RATE-09   TO #GW-DEATH-RATE
                    MOVE #GN-DEATH-RATE-09   TO #GN-DEATH-RATE
                  else                                                   /* vt1 \/
                    if #USED-DATE ge 201201
                        and #used-date lt 201301                                       /* vt3
                      MOVE #GF-MON-RATE-10     TO #GF-MON-RATE
                      MOVE #PL-MON-RATE-10     TO #PL-MON-RATE
                      MOVE #GF-WID-MON-RATE-10 TO #GF-WID-MON-RATE
                      MOVE #IO-WID-MON-RATE-10 TO #IO-WID-MON-RATE
                      MOVE #GW-DEATH-RATE-10   TO #GW-DEATH-RATE
                      MOVE #GN-DEATH-RATE-10   TO #GN-DEATH-RATE
                    else                                                              /* vt3  \/
                      if #USED-DATE ge 201301
                          and #used-date lt 201401                                      /* vt4
                        MOVE #GF-MON-RATE-11     TO #GF-MON-RATE
                        MOVE #PL-MON-RATE-11    TO #PL-MON-RATE
                        MOVE #GF-WID-MON-RATE-11 TO #GF-WID-MON-RATE
                        MOVE #IO-WID-MON-RATE-11 TO #IO-WID-MON-RATE
                        MOVE #GW-DEATH-RATE-11   TO #GW-DEATH-RATE
                        MOVE #GN-DEATH-RATE-11   TO #GN-DEATH-RATE
*                      end-if                                                           /* vt3 /\
                      else                                                          /* vt4 \/
                        if #USED-DATE ge 201401
                            and #used-date lt 201501
                          MOVE #GF-MON-RATE-12    TO #GF-MON-RATE
                          MOVE #PL-MON-RATE-12    TO #PL-MON-RATE
                          MOVE #GF-WID-MON-RATE-12 TO #GF-WID-MON-RATE
                          MOVE #IO-WID-MON-RATE-12 TO #IO-WID-MON-RATE
                          MOVE #GW-DEATH-RATE-12   TO #GW-DEATH-RATE
                          MOVE #GN-DEATH-RATE-12   TO #GN-DEATH-RATE
                        else                                                               /* vt5 \/
                          if #USED-DATE ge 201501
                              and #used-date lt 201701                                       /* vt6
                            MOVE #GF-MON-RATE-13    TO #GF-MON-RATE
                            MOVE #PL-MON-RATE-13    TO #PL-MON-RATE
                            MOVE #GF-WID-MON-RATE-13 TO #GF-WID-MON-RATE
                            MOVE #IO-WID-MON-RATE-13 TO #IO-WID-MON-RATE
                            MOVE #GW-DEATH-RATE-13   TO #GW-DEATH-RATE
                            MOVE #GN-DEATH-RATE-13   TO #GN-DEATH-RATE                    /* vt5 /\
                          else                                                               /* vt6 \/
                            if #USED-DATE ge 201701
                                and #used-date lt 201801                                      /* vt7
                              MOVE #GF-MON-RATE-14    TO #GF-MON-RATE
                              MOVE #PL-MON-RATE-14    TO #PL-MON-RATE
                              MOVE #GF-WID-MON-RATE-14 TO #GF-WID-MON-RATE
                              MOVE #IO-WID-MON-RATE-14 TO #IO-WID-MON-RATE
                              MOVE #GW-DEATH-RATE-14   TO #GW-DEATH-RATE
                              MOVE #GN-DEATH-RATE-14   TO #GN-DEATH-RATE                    /* vt6 /\
                            else                                                          /* vt7 \/
                              if #USED-DATE ge 201801
                                MOVE #GF-MON-RATE-15    TO #GF-MON-RATE
                                MOVE #PL-MON-RATE-15   TO #PL-MON-RATE
                                MOVE #GF-WID-MON-RATE-15 TO #GF-WID-MON-RATE
                                MOVE #IO-WID-MON-RATE-15 TO #IO-WID-MON-RATE
                                MOVE #GW-DEATH-RATE-15   TO #GW-DEATH-RATE
                                MOVE #GN-DEATH-RATE-15   TO #GN-DEATH-RATE
                              end-if
                            end-if                                                          /* vt6 /\
                          end-if
                        end-if                                                      /* vt4 /\
                      end-if                                                                  /* vt5
                    end-if                                               /* vt1 /\
                  END-IF
                END-IF
              END-IF
            END-IF
          END-IF
        END-IF
      END-IF
    END-IF
  END-IF
END-IF
*
END-SUBROUTINE
*
END
