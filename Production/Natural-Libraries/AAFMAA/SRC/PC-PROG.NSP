* >Natural Source Header 000000
* :Mode S
* :CP ISO_8859-1:1987
* :LineIncrement 10
* <Natural Source Header
* PROGRAM-ID: PC-PROG
DEFINE DATA
*
GLOBAL USING PC-CGA-G WITH MASTER-BLOCK
*
LOCAL
1 #COUNTERS
  2 #RECS-READ        (P5)
  2 #CNT              (P5)
  2 #I1               (I2)
1 #ID-NUMBER  (N6)
1 #NAME       (A25)
1 #RANK       (A3)
1 #ERR-MSG   (A60)
1 #MTD-ACV-PREM-ADJ (A36)
1 REDEFINE #MTD-ACV-PREM-ADJ
 2 #MTD-ACV-PREM-ADJ-P (P5.2/9)
*
1 ST-V VIEW OF A-STATUS
 2 MTD-ACV-PREM-ADJ (9)
 2 ISSUE-DATE (9)
*
1 #LAST-NAME     (A25)
1 #FIRST-MID     (A25)
1 #SUF1          (A25)
1 #SUF2          (A25)
1 #SUF3          (A25)
*
END-DEFINE
*
RESET #CGA-G
ADD 1 TO #CGA-G.#CGA-INFO-5N
MOVE 'A' TO #CGA-G.#CGA-INFO-10A
MOVE 'Last Prog = PC-PROG' TO #CGA-G.#CGA-INFO-20A
MOVE 30277 TO #ID-NUMBER
FIND ST-V WITH MEMBER-KEY = '030277'
END-FIND
* DISPLAY MTD-ACV-PREM-ADJ (1:9) ISSUE-DATE (1:9)
MOVE MTD-ACV-PREM-ADJ (*) TO #MTD-ACV-PREM-ADJ-P (*)
*
CALLNAT 'PC-SUBPR' USING #ID-NUMBER #NAME #RANK #ERR-MSG #CGA-G
   #MTD-ACV-PREM-ADJ ISSUE-DATE (1:9)
*
* MOVE #MTD-ACV-PREM-ADJ (*) TO MTD-ACV-PREM-ADJ (*)
SEPARATE #NAME LEFT INTO #LAST-NAME #FIRST-MID #SUF1  #SUF2 #SUF3
                WITH DELIMITER ','
     COMPRESS #FIRST-MID #LAST-NAME #SUF1 #SUF2 #SUF3 INTO #NAME
     COMPRESS #RANK #NAME INTO #NAME
*
* WRITE 'NAME = ' #NAME
* WRITE 'Error-msg = ' #ERR-MSG
* WRITE 'FINAL MESSAGES - prog count = ' #CGA-G.#CGA-INFO-5N
* WRITE  #CGA-G.#CGA-INFO-20A
* WRITE  #CGA-G.#CGA-INFO-10A
  DISPLAY #MTD-ACV-PREM-ADJ-P (1:9) ISSUE-DATE (1:9)
*
END
