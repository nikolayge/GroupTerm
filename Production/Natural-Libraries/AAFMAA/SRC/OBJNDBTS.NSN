* >Natural Source Header 000000
* :Mode S
* :CP ISO_8859-1:1987
* :LineIncrement 10
* <Natural Source Header
*
* PRGRAM ID: OBJNDBTS
*
* A-ADDRESS-POOL          22
* A-ADDRESS-RELATIONSHIP  23
* A-CONTACT-PHONE         24
* A-CONTACT-EMAIL         25
* A-CONTACT-RELATIONSHIPS 26
* A-CONTACTS              27
* A-CONTACT-NOTES         28
* A-TRANSACTION-REGISTER  34
* A-ACCOUNTING-REGISTER   35
* A-STATUS                40
* A-APPL-TRACKING         46
*
DEFINE DATA
PARAMETER USING OBJADBTS
LOCAL
1 AP-V VIEW OF A-ADDRESS-POOL
  2 LAST-DATE-UPD (N8)
  2 LAST-TIME-UPD (N7)
  2 LAST-USER-UPD (A8)
1 AR-V VIEW OF A-ADDRESS-RELATIONSHIP
  2 LAST-DATE-UPD (N8)
  2 LAST-TIME-UPD (N7)
  2 LAST-USER-UPD (A8)
1 PH-V VIEW OF A-CONTACT-PHONE
  2 LAST-DATE-UPD (N8)
  2 LAST-TIME-UPD (N7)
  2 LAST-USER-UPD (A8)
1 EM-V VIEW OF A-CONTACT-EMAIL
  2 LAST-DATE-UPD (N8)
  2 LAST-TIME-UPD (N7)
  2 LAST-USER-UPD (A8)
1 CO-V VIEW OF A-CONTACTS
  2 LAST-DATE-UPD (N8)
  2 LAST-TIME-UPD (N7)
  2 LAST-USER-UPD (A8)
1 CR-V VIEW OF A-CONTACT-RELATIONSHIPS
  2 LAST-DATE-UPD (N8)
  2 LAST-TIME-UPD (N7)
  2 LAST-USER-UPD (A8)
1 ST-V VIEW OF A-STATUS
  2 DTS-DATN (P9)
  2 DTS-TIMN (P7)
*  2 LAST-USER-UPD (A8)
*
1 #GET    (I4) CONST <0>
1 #ADD    (I4) CONST <1>
1 #UPDATE (I4) CONST <2>
*
END-DEFINE
*
DECIDE ON FIRST VALUE OF #FILE-NAME
  VALUE 'A-ADDRESS-POOL'
    PERFORM AP-STAMP
  VALUE 'A-ADDRESS-RELATIONSHIP'
    PERFORM AR-STAMP
  VALUE 'A-CONTACT-PHONE'
    PERFORM PH-STAMP
  VALUE 'A-CONTACT-EMAIL'
    PERFORM EM-STAMP
  VALUE 'A-CONTACTS'
    PERFORM CO-STAMP
  VALUE 'A-CONTACT-RELATIONSHIPS'
    PERFORM CR-STAMP
  VALUE 'A-STATUS'
    PERFORM ST-STAMP
  NONE VALUE  IGNORE
END-DECIDE
LUU-NAME := FUNCTION-NAME (< #DB.LAST-USER-UPD >)
*
DEFINE PH-STAMP
/*     ========
IF #REQUEST = #GET
  GET PH-V #FILE-REC-ISN
  MOVE BY NAME PH-V TO #DB
ELSE
  IF #REQUEST = #ADD OR= #UPDATE
    GET PH-V #FILE-REC-ISN
    PH-V.LAST-DATE-UPD := *DATN
    PH-V.LAST-TIME-UPD := *TIMN
    PH-V.LAST-USER-UPD := #DB.LAST-USER-UPD
    UPDATE (0085)
  ELSE
    #Message := 'INVALID REQUEST'
  END-IF
END-IF
END-SUBROUTINE
*
DEFINE AR-STAMP
/*     ========
IF #REQUEST = #GET
  GET AR-V #FILE-REC-ISN
  MOVE BY NAME AR-V TO #DB
ELSE
  IF #REQUEST = #ADD OR= #UPDATE
    GET AR-V #FILE-REC-ISN
    AR-V.LAST-DATE-UPD := *DATN
    AR-V.LAST-TIME-UPD := *TIMN
    AR-V.LAST-USER-UPD := #DB.LAST-USER-UPD
    UPDATE (0103)
  ELSE
    #Message := 'INVALID REQUEST'
  END-IF
END-IF
END-SUBROUTINE
*
DEFINE AP-STAMP
/*     ========
IF #REQUEST = #GET
  GET AP-V #FILE-REC-ISN
  MOVE BY NAME AP-V TO #DB
ELSE
  IF #REQUEST = #ADD OR= #UPDATE
    GET AP-V #FILE-REC-ISN
    AP-V.LAST-DATE-UPD := *DATN
    AP-V.LAST-TIME-UPD := *TIMN
    AP-V.LAST-USER-UPD := #DB.LAST-USER-UPD
    UPDATE (0121)
  ELSE
    #Message := 'INVALID REQUEST'
  END-IF
END-IF
END-SUBROUTINE
*
DEFINE EM-STAMP
/*     ========
IF #REQUEST = #GET
  GET EM-V #FILE-REC-ISN
  MOVE BY NAME EM-V TO #DB
ELSE
  IF #REQUEST = #ADD OR= #UPDATE
    GET EM-V #FILE-REC-ISN
    EM-V.LAST-DATE-UPD := *DATN
    EM-V.LAST-TIME-UPD := *TIMN
    EM-V.LAST-USER-UPD := #DB.LAST-USER-UPD
    UPDATE (0139)
  ELSE
    #Message := 'INVALID REQUEST'
  END-IF
END-IF
END-SUBROUTINE
*
DEFINE CO-STAMP
/*     ========
IF #REQUEST = #GET
  GET CO-V #FILE-REC-ISN
  MOVE BY NAME CO-V TO #DB
ELSE
  IF #REQUEST = #ADD OR= #UPDATE
    GET CO-V #FILE-REC-ISN
    CO-V.LAST-DATE-UPD := *DATN
    CO-V.LAST-TIME-UPD := *TIMN
    CO-V.LAST-USER-UPD := #DB.LAST-USER-UPD
    UPDATE (0157)
  ELSE
    #Message := 'INVALID REQUEST'
  END-IF
END-IF
END-SUBROUTINE
*
DEFINE CR-STAMP
/*     ========
IF #REQUEST = #GET
  GET CR-V #FILE-REC-ISN
  MOVE BY NAME CR-V TO #DB
ELSE
  IF #REQUEST = #ADD OR= #UPDATE
    GET CR-V #FILE-REC-ISN
    CR-V.LAST-DATE-UPD := *DATN
    CR-V.LAST-TIME-UPD := *TIMN
    CR-V.LAST-USER-UPD := #DB.LAST-USER-UPD
    UPDATE (0175)
  ELSE
    #Message := 'INVALID REQUEST'
  END-IF
END-IF
END-SUBROUTINE
*
DEFINE ST-STAMP
/*     ========
IF #REQUEST = #GET
  GET ST-V #FILE-REC-ISN
  #DB.LAST-DATE-UPD := ST-V.DTS-DATN
  #DB.LAST-TIME-UPD := ST-V.DTS-TIMN
ELSE
  IF #REQUEST = #ADD OR= #UPDATE
    GET ST-V #FILE-REC-ISN
    ST-V.DTS-DATN := *DATN
    ST-V.DTS-TIMN := *TIMN
*    CR-V.LAST-USER-UPD := #DB.LAST-USER-UPD
    UPDATE (0194)
  ELSE
    #Message := 'INVALID REQUEST'
  END-IF
END-IF
END-SUBROUTINE
*
END
