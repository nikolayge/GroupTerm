* >Natural Source Header 000000
* :Mode S
* :CP ISO_8859-1:1987
* <Natural Source Header
/** New Function RTEF0003.
/**
/** :author nguentchev
DEFINE FUNCTION Get1035Adj RETURNS (N5.6)
  DEFINE DATA
  PARAMETER
  1 #AGE           (I2) BY VALUE
  1 #SMOKER-FLAG   (A1)
  1 #GENDER-CD     (A1)
  1 #VERSION       (A1)
  LOCAL
  1 #MECC-KEY (A5) 1 REDEFINE #MECC-KEY
    2 #TYPE   (A1)  /* P = 7PAY A = ADJ1035
    2 #AGE-2  (A2)
    2 #GENDER (A1)
    2 #SMOKER (A1)
  1 PRTES-V VIEW OF A-PRODUCT-RATES
    2 WL-RATE   (N7.2)
    2 MECC-KEY  (A5)
  1 #1035-ADJ-NON-SM
 2 #N00 (A49) INIT <'163071-162840-162823-162806-162786-162767-162753-'>
 2 #N07 (A49) INIT <'162747-162754-162775-162812-162863-162924-162986-'>
 2 #N14 (A49) INIT <'163042-163088-163122-163142-163153-163153-163144-'>
 2 #N21 (A49) INIT <'163130-163113-163096-163080-163068-163062-163062-'>
 2 #N28 (A49) INIT <'163067-163078-163095-163118-163146-163181-163224-'>
 2 #N35 (A49) INIT <'163273-163331-163395-163467-163548-163635-163732-'>
 2 #N42 (A49) INIT <'163837-163951-164077-164214-164365-164531-164717-'>
 2 #N49 (A49) INIT <'164928-165169-165444-165752-166095-166475-166891-'>
 2 #N56 (A49) INIT <'167349-167857-168427-169069-169793-170609-171522-'>
 2 #N63 (A49) INIT <'172535-173647-174869-176220-177721-179411-181333-'>
    2 #N70 (A14) INIT <'183522-185555-'>
  1 REDEFINE #1035-ADJ-NON-SM
    2 #1035-ADJ-OCC-NS (72)
      3 #1035-ADJ-NS   (N0.6)
      3 #1035-ADJ-NS-X (A1)
*
  1 #1035-ADJ-SMOKER
 2 #N00 (A49) INIT <'163071-162840-162823-162806-162786-162767-162753-'>
 2 #N07 (A49) INIT <'162747-162754-162779-162827-162901-162995-163105-'>
 2 #N14 (A49) INIT <'163223-163317-163377-163416-163439-163448-163442-'>
 2 #N21 (A49) INIT <'163427-163405-163383-163363-163350-163348-163356-'>
 2 #N28 (A49) INIT <'163376-163406-163447-163496-163558-163633-163722-'>
 2 #N35 (A49) INIT <'163827-163951-164093-164254-164434-164633-164850-'>
 2 #N42 (A49) INIT <'165084-165335-165606-165896-166209-166551-166931-'>
 2 #N49 (A49) INIT <'167354-167829-168359-168944-169583-170267-170998-'>
 2 #N56 (A49) INIT <'171780-172627-173555-174587-175744-177031-178448-'>
 2 #N63 (A49) INIT <'179985-181629-183378-185244-187262-189480-191955-'>
    2 #N70 (A14) INIT <'194735-196666-'>
  1 REDEFINE #1035-ADJ-SMOKER
    2 #1035-ADJ-OCC-NS (72)
      3 #1035-ADJ-SM   (N0.6)
      3 #1035-ADJ-SM-X (A1)
  END-DEFINE
/*
  RESET Get1035Adj
IF #VERSION = '4'
  #TYPE := 'A'
  IF #AGE GT 80
    MOVE 80 TO #AGE
  END-IF
  MOVE EDITED #AGE (EM=99) TO #AGE-2
  #GENDER := #GENDER-CD
  IF #SMOKER-FLAG = 'S' OR= 'Y'
    #SMOKER := 'Y'
  ELSE
    #SMOKER := 'N'
  END-IF
  FIND PRTES-V WITH MECC-KEY = #MECC-KEY
    Get1035Adj := PRTES-V.WL-RATE / 1000000
  END-FIND
ELSE
  ADD 1 TO #AGE
  IF #AGE GT 72
    MOVE 72 TO #AGE
  END-IF
  IF #SMOKER-FLAG = 'S' OR= 'Y'
    Get1035Adj := #1035-ADJ-SM (#AGE)
  ELSE
    Get1035Adj := #1035-ADJ-NS (#AGE)
  END-IF
END-IF
END-FUNCTION
END
