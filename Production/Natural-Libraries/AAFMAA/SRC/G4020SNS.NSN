* >Natural Source Header 000000
* :Mode S
* :CP ISO_8859-1:1987
* :LineIncrement 10
* <Natural Source Header
* PGM-ID: G4020SNS
*     'NS' COMMAND PROCESSING   (NOTE DISPLAY) LETTER FORMAT NAMES
*     NGG  20101110
* MODIFICATIONS:
* bz-Name-C 07/07/2017     Fine Names. Keep all capital  
*
DEFINE DATA
PARAMETER
1 #ID-NUMBER            (N6)
1 #MEMBER-NAME          (A42)
1 #WIDOW-NAME           (A42)
LOCAL
1 #FORMATED-NAME        (A)   DYNAMIC
1 STATUS VIEW OF A-STATUS
  2 MEMBER-CONTACT-ID   (N8)
  2 SPOUSE-CONTACT-ID   (N8)
END-DEFINE
*
FIND STATUS WITH ID-NUMBER = #ID-NUMBER
  #FORMATED-NAME := '!SCREEN'                  /* bz-Name-C
  CALLNAT 'GPRS0CNT' MEMBER-CONTACT-ID #FORMATED-NAME
  IF *LENGTH ( #FORMATED-NAME ) > 42
    MOVE SUBSTR (#FORMATED-NAME,1,42) TO #MEMBER-NAME
  ELSE
    #MEMBER-NAME := #FORMATED-NAME
  END-IF
  #FORMATED-NAME := '!SCREEN'                 /* bz-Name-C 
  CALLNAT 'GPRS0CNT' SPOUSE-CONTACT-ID #FORMATED-NAME
  IF *LENGTH ( #FORMATED-NAME ) > 42
    MOVE SUBSTR (#FORMATED-NAME,1,42) TO #WIDOW-NAME
  ELSE
    #WIDOW-NAME := #FORMATED-NAME
  END-IF
END-FIND
*
END
