* >Natural Source Header 000000
* :Mode S
* :CP ISO_8859-1:1987
* :LineIncrement 10
* <Natural Source Header
DEFINE DATA 
LOCAL USING OBJLMB01   
LOCAL
1 #TAB (A1) CONST <H'09'>
1 #SVC-PAID-TO-DATE (N8)
1 REDEFINE #SVC-PAID-TO-DATE
  2 #YYYY         (N4)
  2 #MM           (N2) 
  2 #DD           (N2)
END-DEFINE
*
DEFINE WORK FILE 1 "/usr/SAG/tmp/Service_Paid_to_date.txt"
READ SVC-MEMBER-V BY SVC-ID-NUMBER
  #SVC-PAID-TO-DATE := SVC-PAID-TO-DATE
  DECIDE FOR FIRST CONDITION
    WHEN #MM = 2 AND #DD > 28
      #DD := 28
      SVC-PAID-TO-DATE := #SVC-PAID-TO-DATE
      UPDATE
      WRITE WORK FILE 1 SVC-ID-NUMBER #TAB SVC-PAID-TO-DATE
    WHEN (#MM = 4 OR = 6 OR = 9 OR = 11) AND #DD > 30   
      #DD := 30
      SVC-PAID-TO-DATE := #SVC-PAID-TO-DATE
      UPDATE
      WRITE WORK FILE 1 SVC-ID-NUMBER #TAB SVC-PAID-TO-DATE 
    WHEN NONE
      IGNORE
  END-DECIDE
  END TRANSACTION
END-READ
END  
