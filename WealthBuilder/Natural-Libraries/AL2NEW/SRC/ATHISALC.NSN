* >Natural Source Header 000000
* :Mode S
* :CP ISO_8859-1:1987
* :LineIncrement 10
* <Natural Source Header
/** New Subprogram ATHISALC.
/**
/** :author nguentchev
/* TODO Enter your code here
DEFINE DATA
PARAMETER
1 IS-ISS-AGE   (P3.0)  /* In
1 IS-DURATION  (P3.0)  /* In
1 DISP-X       (P3.0)  /* In
1 COMPANY-GIR  (F8)    /* In
1 PLAN-CODE    (A3)    /* In
1 LST-SNG-PA   (F8)
1 NXT-SNG-PA   (F8)
1 AL-M-GIR     (F8)
LOCAL
1 #TEMPFLT1 (F8)
1 #TEMPFLT2 (F8)
1 AGE-ADJ   (I2)
1 AL2-ADMIN-COST (F8) INIT <0.75E-2>
1 AL-ADMIN-COST  (F8) INIT <0.5E-2>
1 COMPANY-GIR-2  (F8) INIT <3.5E-2>
1 ADMIN-COST     (F8)
LOCAL USING ATHISAL2
LOCAL USING ATHISMTS
END-DEFINE
*
IF PLAN-CODE = 'AL'
  ADMIN-COST := AL-ADMIN-COST
  COMPUTE ROUNDED #TEMPFLT2 = 1 + COMPANY-GIR
ELSE
  ADMIN-COST := AL2-ADMIN-COST
  COMPUTE ROUNDED #TEMPFLT2 = 1 + COMPANY-GIR-2
END-IF
COMPUTE ROUNDED #TEMPFLT1 = 1 / 12
AL-M-GIR := (#TEMPFLT2 - ADMIN-COST) ** #TEMPFLT1 - 1
*
IF PLAN-CODE = 'AL2'
  IF IS-ISS-AGE > 99
    MOVE 1.0000000 TO LST-SNG-PA NXT-SNG-PA
  ELSE
    MOVE IS-ISS-AGE TO AGE-ADJ
    ADD 1 TO AGE-ADJ
    IF IS-DURATION = 0 OR IS-DURATION = 1
      MOVE #A(AGE-ADJ) TO LST-SNG-PA
      MOVE #B(AGE-ADJ) TO NXT-SNG-PA
    ELSE
      IF IS-DURATION = 2
        MOVE #B(AGE-ADJ) TO LST-SNG-PA
        MOVE #C(AGE-ADJ) TO NXT-SNG-PA
      ELSE
        COMPUTE DISP-X = IS-DURATION - 3
        ADD DISP-X TO AGE-ADJ
        IF IS-ISS-AGE + DISP-X > 99
          MOVE 1 TO LST-SNG-PA NXT-SNG-PA
        ELSE
          MOVE #C(AGE-ADJ) TO LST-SNG-PA
          ADD 1 TO AGE-ADJ
          IF IS-ISS-AGE + DISP-X + 1 > 99
            MOVE 1 TO NXT-SNG-PA
          ELSE
            MOVE #C(AGE-ADJ) TO NXT-SNG-PA
          END-IF
        END-IF
      END-IF
    END-IF
  END-IF
ELSE
  IF IS-ISS-AGE > 79
    MOVE 1.0000000 TO LST-SNG-PA NXT-SNG-PA
  ELSE
    MOVE IS-ISS-AGE TO AGE-ADJ
    ADD 1 TO AGE-ADJ
    IF IS-DURATION = 0 OR IS-DURATION = 1
      MOVE SNG-PAY-AL-A(AGE-ADJ) TO LST-SNG-PA
      MOVE SNG-PAY-AL-B(AGE-ADJ) TO NXT-SNG-PA
    ELSE
      IF IS-DURATION = 2
        MOVE SNG-PAY-AL-B(AGE-ADJ) TO LST-SNG-PA
        MOVE SNG-PAY-AL-C(AGE-ADJ) TO NXT-SNG-PA
      ELSE
        COMPUTE DISP-X = IS-DURATION - 3
        ADD DISP-X TO AGE-ADJ
        IF IS-ISS-AGE + DISP-X > 79
          MOVE 1 TO LST-SNG-PA NXT-SNG-PA
        ELSE
          MOVE SNG-PAY-AL-C(AGE-ADJ) TO LST-SNG-PA
          ADD 1 TO AGE-ADJ
          IF IS-ISS-AGE + DISP-X + 1 > 79
            MOVE 1 TO NXT-SNG-PA
          ELSE
            MOVE SNG-PAY-AL-C(AGE-ADJ) TO NXT-SNG-PA
          END-IF
        END-IF
      END-IF
    END-IF
  END-IF
END-IF
END
